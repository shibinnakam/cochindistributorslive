"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[974,993],{2974:function(e,a,t){t.r(a),t.d(a,{default:function(){return p}});var s=t(6768),l=t(5130),o=t(4232);const i={class:"leave-container"},r={class:"buttons"},n=["disabled"],u=["disabled"];function c(e,a,t,c,d,f){return(0,s.uX)(),(0,s.CE)("div",i,[a[6]||(a[6]=(0,s.Lk)("h2",null,"Apply for Leave",-1)),(0,s.Lk)("form",{onSubmit:a[3]||(a[3]=(0,l.D$)((...e)=>f.submitLeave&&f.submitLeave(...e),["prevent"])),class:"leave-form"},[a[4]||(a[4]=(0,s.Lk)("label",{for:"leave-date"},"Date",-1)),(0,s.bo)((0,s.Lk)("input",{id:"leave-date",type:"date","onUpdate:modelValue":a[0]||(a[0]=e=>d.date=e),required:""},null,512),[[l.Jo,d.date]]),a[5]||(a[5]=(0,s.Lk)("label",{for:"leave-reason"},"Reason",-1)),(0,s.bo)((0,s.Lk)("textarea",{id:"leave-reason","onUpdate:modelValue":a[1]||(a[1]=e=>d.reason=e),placeholder:"Enter your reason",required:""},null,512),[[l.Jo,d.reason]]),(0,s.Lk)("div",r,[(0,s.Lk)("button",{type:"submit",disabled:d.loading},(0,o.v_)(d.loading?"Submitting...":"Request Leave"),9,n),(0,s.Lk)("button",{type:"button",onClick:a[2]||(a[2]=(...e)=>f.resetForm&&f.resetForm(...e)),disabled:d.loading}," Clear ",8,u)])],32),d.message?((0,s.uX)(),(0,s.CE)("p",{key:0,class:(0,o.C4)({success:d.isSuccess,error:!d.isSuccess})},(0,o.v_)(d.message),3)):(0,s.Q3)("",!0)])}var d={data(){return{date:"",reason:"",message:"",isSuccess:!1,loading:!1,leaves:[]}},computed:{staffEmail(){const e=JSON.parse(localStorage.getItem("user"));return e?.email||""}},mounted(){this.staffEmail&&this.fetchLeaves()},methods:{async submitLeave(){if(!this.staffEmail)return this.message="You must be logged in!",void(this.isSuccess=!1);if(!this.date||!this.reason.trim())return this.message="Please fill all fields.",void(this.isSuccess=!1);this.loading=!0;try{const e=await fetch("http://localhost:5000/api/leaves/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.staffEmail,date:this.date,reason:this.reason.trim()})}),a=await e.json();e.ok?(this.message=a.message||"Leave request submitted!",this.isSuccess=!0,this.resetForm(),this.fetchLeaves()):(this.message=a.error||"Failed to submit leave",this.isSuccess=!1)}catch(e){console.error(e),this.message="Error submitting leave. Try again later.",this.isSuccess=!1}finally{this.loading=!1}},resetForm(){this.date="",this.reason=""},async fetchLeaves(){try{const e=await fetch(`http://localhost:5000/api/leaves/my?email=${this.staffEmail}`),a=await e.json();this.leaves=a||[]}catch(e){console.error("Error fetching leaves:",e)}}}},f=t(1241);const h=(0,f.A)(d,[["render",c],["__scopeId","data-v-781ca996"]]);var p=h},5993:function(e,a,t){t.r(a),t.d(a,{default:function(){return A}});var s=t(6768),l=t(4232),o=t(5130);const i={class:"staff-dashboard"},r={class:"sidebar"},n={class:"arrow"},u={key:0,class:"submenu"},c={class:"content"},d={key:0,class:"dashboard-tab"},f={class:"stats-grid"},h={class:"stat-box total-items"},p={class:"stat-box leaves-taken"},m={class:"stat-box pending-tasks"},v={class:"stat-box completed-tasks"},k={key:1,class:"profile-tab"},L={class:"profile-card"},b={class:"photo-section"},g=["src"],y={key:0,class:"message"},S={key:2,class:"items-tab"},C={key:3,class:"apply-leave-tab"},T={key:4,class:"leave-status-tab"},E={class:"leave-table"};function P(e,a,t,P,w,F){const _=(0,s.g2)("StaffLeave");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("aside",r,[a[16]||(a[16]=(0,s.Lk)("h2",{class:"sidebar-title"},"Staff Panel",-1)),(0,s.Lk)("ul",null,[(0,s.Lk)("li",{class:(0,l.C4)({active:"dashboard"===w.currentTab}),onClick:a[0]||(a[0]=e=>w.currentTab="dashboard")}," Dashboard ",2),(0,s.Lk)("li",{class:(0,l.C4)({active:"profile"===w.currentTab}),onClick:a[1]||(a[1]=e=>w.currentTab="profile")}," Profile ",2),(0,s.Lk)("li",{class:(0,l.C4)({active:"items"===w.currentTab}),onClick:a[2]||(a[2]=e=>w.currentTab="items")}," Manage Items ",2),(0,s.Lk)("li",{onClick:a[3]||(a[3]=(...e)=>F.toggleLeaves&&F.toggleLeaves(...e)),class:"has-submenu"},[a[15]||(a[15]=(0,s.eW)(" Leaves ",-1)),(0,s.Lk)("span",n,(0,l.v_)(w.showLeaves?"â–¼":"â–¶"),1)]),w.showLeaves?((0,s.uX)(),(0,s.CE)("ul",u,[(0,s.Lk)("li",{class:(0,l.C4)({active:"apply-leave"===w.currentTab}),onClick:a[4]||(a[4]=(0,o.D$)(e=>w.currentTab="apply-leave",["stop"]))}," Apply for Leave ",2),(0,s.Lk)("li",{class:(0,l.C4)({active:"leave-status"===w.currentTab}),onClick:a[5]||(a[5]=(0,o.D$)(e=>w.currentTab="leave-status",["stop"]))}," Leave Status ",2)])):(0,s.Q3)("",!0),(0,s.Lk)("li",{onClick:a[6]||(a[6]=(...e)=>F.logout&&F.logout(...e))},"Logout")])]),(0,s.Lk)("main",c,["dashboard"===w.currentTab?((0,s.uX)(),(0,s.CE)("div",d,[a[17]||(a[17]=(0,s.Lk)("h2",null,"Dashboard",-1)),(0,s.Lk)("div",f,[(0,s.Lk)("div",h," Total Items: "+(0,l.v_)(w.stats.totalItems),1),(0,s.Lk)("div",p," Leaves Taken: "+(0,l.v_)(w.stats.leavesTaken),1),(0,s.Lk)("div",m," Pending Tasks: "+(0,l.v_)(w.stats.pendingTasks),1),(0,s.Lk)("div",v," Completed Tasks: "+(0,l.v_)(w.stats.completedTasks),1)])])):(0,s.Q3)("",!0),"profile"===w.currentTab?((0,s.uX)(),(0,s.CE)("div",k,[a[26]||(a[26]=(0,s.Lk)("h2",null,"My Profile",-1)),(0,s.Lk)("div",L,[(0,s.Lk)("div",b,[(0,s.Lk)("img",{src:w.staff.profilePhoto?w.apiBase+w.staff.profilePhoto:w.defaultPhoto,alt:"Profile Photo",class:"profile-photo"},null,8,g),(0,s.Lk)("input",{type:"file",onChange:a[7]||(a[7]=(...e)=>F.onFileChange&&F.onFileChange(...e))},null,32)]),(0,s.Lk)("form",{onSubmit:a[14]||(a[14]=(0,o.D$)((...e)=>F.updateProfile&&F.updateProfile(...e),["prevent"])),class:"profile-form"},[a[19]||(a[19]=(0,s.Lk)("label",null,"Name",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>w.staff.name=e),required:""},null,512),[[o.Jo,w.staff.name]]),a[20]||(a[20]=(0,s.Lk)("label",null,"Email (cannot be changed)",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>w.staff.email=e),disabled:""},null,512),[[o.Jo,w.staff.email]]),a[21]||(a[21]=(0,s.Lk)("label",null,"Phone",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>w.staff.phone=e),required:""},null,512),[[o.Jo,w.staff.phone]]),a[22]||(a[22]=(0,s.Lk)("label",null,"Gender",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[11]||(a[11]=e=>w.staff.gender=e)},a[18]||(a[18]=[(0,s.Lk)("option",{value:"male"},"Male",-1),(0,s.Lk)("option",{value:"female"},"Female",-1),(0,s.Lk)("option",{value:"other"},"Other",-1)]),512),[[o.u1,w.staff.gender]]),a[23]||(a[23]=(0,s.Lk)("label",null,"Address",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>w.staff.address=e),required:""},null,512),[[o.Jo,w.staff.address]]),a[24]||(a[24]=(0,s.Lk)("label",null,"Pincode",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>w.staff.pincode=e),required:""},null,512),[[o.Jo,w.staff.pincode]]),a[25]||(a[25]=(0,s.Lk)("button",{type:"submit"},"Update Profile",-1))],32)]),w.message?((0,s.uX)(),(0,s.CE)("p",y,(0,l.v_)(w.message),1)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),"items"===w.currentTab?((0,s.uX)(),(0,s.CE)("div",S,a[27]||(a[27]=[(0,s.Lk)("h2",null,"Manage Items",-1),(0,s.Lk)("p",null,"ðŸ‘‰ Here you can add, update, or delete items.",-1)]))):(0,s.Q3)("",!0),"apply-leave"===w.currentTab?((0,s.uX)(),(0,s.CE)("div",C,[(0,s.bF)(_,{onLeaveSubmitted:F.fetchLeaveStatus},null,8,["onLeaveSubmitted"])])):(0,s.Q3)("",!0),"leave-status"===w.currentTab?((0,s.uX)(),(0,s.CE)("div",T,[a[29]||(a[29]=(0,s.Lk)("h2",null,"Leave Status",-1)),(0,s.Lk)("table",E,[a[28]||(a[28]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Reason"),(0,s.Lk)("th",null,"Date"),(0,s.Lk)("th",null,"Status")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(w.leaveStatus,e=>((0,s.uX)(),(0,s.CE)("tr",{key:e._id},[(0,s.Lk)("td",null,(0,l.v_)(e.reason),1),(0,s.Lk)("td",null,(0,l.v_)(F.formatDate(e.date)),1),(0,s.Lk)("td",null,(0,l.v_)(e.status),1)]))),128))])])])):(0,s.Q3)("",!0)])])}t(4114),t(8111),t(7588);var w=t(586),F=t(2974),_={components:{StaffLeave:F["default"]},data(){return{currentTab:"dashboard",showLeaves:!1,staff:{name:"",email:"",phone:"",gender:"",address:"",pincode:"",profilePhoto:""},stats:{totalItems:0,leavesTaken:0,pendingTasks:0,completedTasks:0},leaveStatus:[],selectedFile:null,message:"",apiBase:"http://localhost:5000",defaultPhoto:"/default-avatar.png"}},methods:{async fetchProfile(){try{const e=localStorage.getItem("token"),a=await w.A.get(`${this.apiBase}/api/staff/me`,{headers:{Authorization:`Bearer ${e}`}});this.staff=a.data.staff}catch{this.message="Error loading profile"}},async fetchStats(){try{const e=localStorage.getItem("token"),a=await w.A.get(`${this.apiBase}/api/staff/stats`,{headers:{Authorization:`Bearer ${e}`}});this.stats=a.data}catch(e){console.error("Error fetching stats",e)}},onFileChange(e){this.selectedFile=e.target.files[0]},async updateProfile(){try{const e=localStorage.getItem("token"),a=new FormData;Object.keys(this.staff).forEach(e=>{"email"!==e&&a.append(e,this.staff[e])}),this.selectedFile&&a.append("profilePhoto",this.selectedFile);const t=await w.A.put(`${this.apiBase}/api/staff/update`,a,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"multipart/form-data"}});this.message=t.data.message,this.fetchProfile()}catch(e){this.message=e.response?.data?.message||"Error updating profile"}},toggleLeaves(){this.showLeaves=!this.showLeaves},logout(){localStorage.removeItem("token"),this.$router.push("/login")},async fetchLeaveStatus(){try{const e=JSON.parse(localStorage.getItem("user")),a=e?.email;if(!a)return;const t=localStorage.getItem("token"),s=await w.A.get(`${this.apiBase}/api/leaves/my`,{headers:{Authorization:`Bearer ${t}`},params:{email:a}});this.leaveStatus=s.data}catch(e){console.error("Error fetching leave status",e)}},formatDate(e){return new Date(e).toLocaleDateString()}},watch:{currentTab(e){"leave-status"===e&&this.fetchLeaveStatus()}},mounted(){this.fetchProfile(),this.fetchStats()}},I=t(1241);const $=(0,I.A)(_,[["render",P],["__scopeId","data-v-57c3d200"]]);var A=$}}]);
//# sourceMappingURL=993.0ab9bff5.js.map