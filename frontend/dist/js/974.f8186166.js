"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[974],{2974:function(e,s,t){t.r(s),t.d(s,{default:function(){return f}});var a=t(6768),i=t(5130),o=t(4232);const r={class:"leave-container"},l={class:"buttons"},n=["disabled"],c=["disabled"];function d(e,s,t,d,u,h){return(0,a.uX)(),(0,a.CE)("div",r,[s[6]||(s[6]=(0,a.Lk)("h2",null,"Apply for Leave",-1)),(0,a.Lk)("form",{onSubmit:s[3]||(s[3]=(0,i.D$)((...e)=>h.submitLeave&&h.submitLeave(...e),["prevent"])),class:"leave-form"},[s[4]||(s[4]=(0,a.Lk)("label",{for:"leave-date"},"Date",-1)),(0,a.bo)((0,a.Lk)("input",{id:"leave-date",type:"date","onUpdate:modelValue":s[0]||(s[0]=e=>u.date=e),required:""},null,512),[[i.Jo,u.date]]),s[5]||(s[5]=(0,a.Lk)("label",{for:"leave-reason"},"Reason",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"leave-reason","onUpdate:modelValue":s[1]||(s[1]=e=>u.reason=e),placeholder:"Enter your reason",required:""},null,512),[[i.Jo,u.reason]]),(0,a.Lk)("div",l,[(0,a.Lk)("button",{type:"submit",disabled:u.loading},(0,o.v_)(u.loading?"Submitting...":"Request Leave"),9,n),(0,a.Lk)("button",{type:"button",onClick:s[2]||(s[2]=(...e)=>h.resetForm&&h.resetForm(...e)),disabled:u.loading}," Clear ",8,c)])],32),u.message?((0,a.uX)(),(0,a.CE)("p",{key:0,class:(0,o.C4)({success:u.isSuccess,error:!u.isSuccess})},(0,o.v_)(u.message),3)):(0,a.Q3)("",!0)])}var u={data(){return{date:"",reason:"",message:"",isSuccess:!1,loading:!1,leaves:[]}},computed:{staffEmail(){const e=JSON.parse(localStorage.getItem("user"));return e?.email||""}},mounted(){this.staffEmail&&this.fetchLeaves()},methods:{async submitLeave(){if(!this.staffEmail)return this.message="You must be logged in!",void(this.isSuccess=!1);if(!this.date||!this.reason.trim())return this.message="Please fill all fields.",void(this.isSuccess=!1);this.loading=!0;try{const e=await fetch("http://localhost:5000/api/leaves/request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.staffEmail,date:this.date,reason:this.reason.trim()})}),s=await e.json();e.ok?(this.message=s.message||"Leave request submitted!",this.isSuccess=!0,this.resetForm(),this.fetchLeaves()):(this.message=s.error||"Failed to submit leave",this.isSuccess=!1)}catch(e){console.error(e),this.message="Error submitting leave. Try again later.",this.isSuccess=!1}finally{this.loading=!1}},resetForm(){this.date="",this.reason=""},async fetchLeaves(){try{const e=await fetch(`http://localhost:5000/api/leaves/my?email=${this.staffEmail}`),s=await e.json();this.leaves=s||[]}catch(e){console.error("Error fetching leaves:",e)}}}},h=t(1241);const m=(0,h.A)(u,[["render",d],["__scopeId","data-v-781ca996"]]);var f=m}}]);
//# sourceMappingURL=974.f8186166.js.map