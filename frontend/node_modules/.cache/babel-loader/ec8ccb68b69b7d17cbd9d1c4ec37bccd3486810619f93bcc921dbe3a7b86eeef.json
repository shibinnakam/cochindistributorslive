{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      staff: {\n        name: \"\",\n        email: \"\",\n        phone: \"\",\n        gender: \"\",\n        address: \"\",\n        pincode: \"\",\n        profilePhoto: \"\"\n      },\n      selectedFile: null,\n      message: \"\",\n      apiBase: \"http://localhost:5000\",\n      // backend base url\n      defaultPhoto: \"/default-avatar.png\" // place a default image in /public\n    };\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(\"http://localhost:5000/api/staff/me\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.staff = res.data.staff;\n      } catch (err) {\n        this.message = \"Error loading profile\";\n      }\n    },\n    onFileChange(e) {\n      this.selectedFile = e.target.files[0];\n    },\n    async updateProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const formData = new FormData();\n        Object.keys(this.staff).forEach(key => {\n          if (key !== \"email\") {\n            formData.append(key, this.staff[key]);\n          }\n        });\n        if (this.selectedFile) {\n          formData.append(\"profilePhoto\", this.selectedFile);\n        }\n        const res = await axios.put(\"http://localhost:5000/api/staff/update\", formData, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.message = res.data.message;\n        this.fetchProfile(); // refresh data\n      } catch (err) {\n        this.message = err.response?.data?.message || \"Error updating profile\";\n      }\n    }\n  },\n  mounted() {\n    this.fetchProfile();\n  }\n};","map":{"version":3,"names":["axios","data","staff","name","email","phone","gender","address","pincode","profilePhoto","selectedFile","message","apiBase","defaultPhoto","methods","fetchProfile","token","localStorage","getItem","res","get","headers","Authorization","err","onFileChange","e","target","files","updateProfile","formData","FormData","Object","keys","forEach","key","append","put","response","mounted"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffPage.vue"],"sourcesContent":["<template>\n  <div class=\"staff-page\">\n    <h2>My Profile</h2>\n\n    <div class=\"profile-card\">\n      <!-- Profile Photo -->\n      <div class=\"photo-section\">\n        <img\n          :src=\"\n            staff.profilePhoto ? apiBase + staff.profilePhoto : defaultPhoto\n          \"\n          alt=\"Profile Photo\"\n          class=\"profile-photo\"\n        />\n        <input type=\"file\" @change=\"onFileChange\" />\n      </div>\n\n      <!-- Profile Info Form -->\n      <form @submit.prevent=\"updateProfile\" class=\"profile-form\">\n        <label>Name</label>\n        <input v-model=\"staff.name\" required />\n\n        <label>Email (cannot be changed)</label>\n        <input v-model=\"staff.email\" disabled />\n\n        <label>Phone</label>\n        <input v-model=\"staff.phone\" required />\n\n        <label>Gender</label>\n        <select v-model=\"staff.gender\">\n          <option value=\"male\">Male</option>\n          <option value=\"female\">Female</option>\n          <option value=\"other\">Other</option>\n        </select>\n\n        <label>Address</label>\n        <input v-model=\"staff.address\" required />\n\n        <label>Pincode</label>\n        <input v-model=\"staff.pincode\" required />\n\n        <button type=\"submit\">Update Profile</button>\n      </form>\n    </div>\n\n    <p v-if=\"message\" class=\"message\">{{ message }}</p>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      staff: {\n        name: \"\",\n        email: \"\",\n        phone: \"\",\n        gender: \"\",\n        address: \"\",\n        pincode: \"\",\n        profilePhoto: \"\",\n      },\n      selectedFile: null,\n      message: \"\",\n      apiBase: \"http://localhost:5000\", // backend base url\n      defaultPhoto: \"/default-avatar.png\", // place a default image in /public\n    };\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(\"http://localhost:5000/api/staff/me\", {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        this.staff = res.data.staff;\n      } catch (err) {\n        this.message = \"Error loading profile\";\n      }\n    },\n    onFileChange(e) {\n      this.selectedFile = e.target.files[0];\n    },\n    async updateProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const formData = new FormData();\n\n        Object.keys(this.staff).forEach((key) => {\n          if (key !== \"email\") {\n            formData.append(key, this.staff[key]);\n          }\n        });\n\n        if (this.selectedFile) {\n          formData.append(\"profilePhoto\", this.selectedFile);\n        }\n\n        const res = await axios.put(\n          \"http://localhost:5000/api/staff/update\",\n          formData,\n          {\n            headers: {\n              Authorization: `Bearer ${token}`,\n              \"Content-Type\": \"multipart/form-data\",\n            },\n          }\n        );\n\n        this.message = res.data.message;\n        this.fetchProfile(); // refresh data\n      } catch (err) {\n        this.message = err.response?.data?.message || \"Error updating profile\";\n      }\n    },\n  },\n  mounted() {\n    this.fetchProfile();\n  },\n};\n</script>\n\n<style scoped>\n.staff-page {\n  max-width: 800px;\n  margin: auto;\n  padding: 20px;\n}\n.profile-card {\n  display: flex;\n  gap: 20px;\n  background: #f9f9f9;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);\n}\n.photo-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.profile-photo {\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  object-fit: cover;\n  margin-bottom: 10px;\n}\n.profile-form {\n  flex: 1;\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 15px;\n}\n.profile-form label {\n  grid-column: span 2;\n  font-weight: bold;\n}\n.profile-form input,\n.profile-form select {\n  grid-column: span 2;\n  padding: 8px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n}\nbutton {\n  grid-column: span 2;\n  padding: 10px;\n  background: #007bff;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n}\nbutton:hover {\n  background: #0056b3;\n}\n.message {\n  margin-top: 15px;\n  color: green;\n  font-weight: bold;\n}\n</style>\n"],"mappings":";;AAkDA,OAAOA,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE;QACLC,IAAI,EAAE,EAAE;QACRC,KAAK,EAAE,EAAE;QACTC,KAAK,EAAE,EAAE;QACTC,MAAM,EAAE,EAAE;QACVC,OAAO,EAAE,EAAE;QACXC,OAAO,EAAE,EAAE;QACXC,YAAY,EAAE;MAChB,CAAC;MACDC,YAAY,EAAE,IAAI;MAClBC,OAAO,EAAE,EAAE;MACXC,OAAO,EAAE,uBAAuB;MAAE;MAClCC,YAAY,EAAE,qBAAqB,CAAE;IACvC,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,YAAYA,CAAA,EAAG;MACnB,IAAI;QACF,MAAMC,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAMC,GAAE,GAAI,MAAMnB,KAAK,CAACoB,GAAG,CAAC,oCAAoC,EAAE;UAChEC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUN,KAAK;UAAG;QAC9C,CAAC,CAAC;QACF,IAAI,CAACd,KAAI,GAAIiB,GAAG,CAAClB,IAAI,CAACC,KAAK;MAC7B,EAAE,OAAOqB,GAAG,EAAE;QACZ,IAAI,CAACZ,OAAM,GAAI,uBAAuB;MACxC;IACF,CAAC;IACDa,YAAYA,CAACC,CAAC,EAAE;MACd,IAAI,CAACf,YAAW,GAAIe,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IACvC,CAAC;IACD,MAAMC,aAAaA,CAAA,EAAG;MACpB,IAAI;QACF,MAAMZ,KAAI,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,MAAMW,QAAO,GAAI,IAAIC,QAAQ,CAAC,CAAC;QAE/BC,MAAM,CAACC,IAAI,CAAC,IAAI,CAAC9B,KAAK,CAAC,CAAC+B,OAAO,CAAEC,GAAG,IAAK;UACvC,IAAIA,GAAE,KAAM,OAAO,EAAE;YACnBL,QAAQ,CAACM,MAAM,CAACD,GAAG,EAAE,IAAI,CAAChC,KAAK,CAACgC,GAAG,CAAC,CAAC;UACvC;QACF,CAAC,CAAC;QAEF,IAAI,IAAI,CAACxB,YAAY,EAAE;UACrBmB,QAAQ,CAACM,MAAM,CAAC,cAAc,EAAE,IAAI,CAACzB,YAAY,CAAC;QACpD;QAEA,MAAMS,GAAE,GAAI,MAAMnB,KAAK,CAACoC,GAAG,CACzB,wCAAwC,EACxCP,QAAQ,EACR;UACER,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUN,KAAK,EAAE;YAChC,cAAc,EAAE;UAClB;QACF,CACF,CAAC;QAED,IAAI,CAACL,OAAM,GAAIQ,GAAG,CAAClB,IAAI,CAACU,OAAO;QAC/B,IAAI,CAACI,YAAY,CAAC,CAAC,EAAE;MACvB,EAAE,OAAOQ,GAAG,EAAE;QACZ,IAAI,CAACZ,OAAM,GAAIY,GAAG,CAACc,QAAQ,EAAEpC,IAAI,EAAEU,OAAM,IAAK,wBAAwB;MACxE;IACF;EACF,CAAC;EACD2B,OAAOA,CAAA,EAAG;IACR,IAAI,CAACvB,YAAY,CAAC,CAAC;EACrB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}