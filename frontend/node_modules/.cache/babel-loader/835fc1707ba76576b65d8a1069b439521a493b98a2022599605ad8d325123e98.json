{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      name: \"\",\n      address: \"\",\n      phone: \"\",\n      password: \"\",\n      gender: \"\",\n      pincode: \"\",\n      profilePhoto: null,\n      profilePhotoPreview: null,\n      message: \"\",\n      submitted: false // track submission\n    };\n  },\n  mounted() {\n    // Check if token is valid and if user already submitted\n    this.checkTokenStatus();\n  },\n  methods: {\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.profilePhoto = file;\n        this.profilePhotoPreview = URL.createObjectURL(file);\n      }\n    },\n    async checkTokenStatus() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n      try {\n        const res = await axios.post(\"http://localhost:5000/api/staff/check-submitted\", {\n          token\n        });\n        if (res.data.submitted) {\n          this.message = \"You have already submitted your registration.\";\n          this.submitted = true;\n        }\n      } catch (err) {\n        this.message = \"Invalid or expired link.\";\n        this.submitted = true;\n      }\n    },\n    async register() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n      if (this.submitted) {\n        this.message = \"You have already submitted.\";\n        return;\n      }\n      try {\n        const formData = new FormData();\n        formData.append(\"token\", token);\n        formData.append(\"name\", this.name);\n        formData.append(\"address\", this.address);\n        formData.append(\"phone\", this.phone);\n        formData.append(\"password\", this.password);\n        formData.append(\"gender\", this.gender);\n        formData.append(\"pincode\", this.pincode);\n        formData.append(\"profilePhoto\", this.profilePhoto);\n        const res = await axios.post(\"http://localhost:5000/api/staff/register\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.message = res.data.message || \"Registration successful!\";\n        this.submitted = true;\n\n        // Redirect if backend provides redirect URL\n        if (res.data.redirect) {\n          setTimeout(() => {\n            this.$router.push(res.data.redirect);\n          }, 2000);\n        }\n      } catch (err) {\n        if (err.response?.data?.alreadySubmitted) {\n          this.message = \"You have already submitted.\";\n          this.submitted = true;\n        } else {\n          this.message = err.response?.data?.message || \"Error submitting registration\";\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","name","address","phone","password","gender","pincode","profilePhoto","profilePhotoPreview","message","submitted","mounted","checkTokenStatus","methods","onFileChange","e","file","target","files","URL","createObjectURL","token","$route","query","res","post","err","register","formData","FormData","append","headers","redirect","setTimeout","$router","push","response","alreadySubmitted"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffRegister.vue"],"sourcesContent":["<template>\n  <div class=\"staff-register\">\n    <h2>Complete Your Registration</h2>\n\n    <!-- Show message first -->\n    <p v-if=\"message\" class=\"message\">{{ message }}</p>\n\n    <!-- Form disabled if submitted -->\n    <form\n      v-if=\"!submitted\"\n      @submit.prevent=\"register\"\n      enctype=\"multipart/form-data\"\n    >\n      <div class=\"form-grid\">\n        <!-- Left column -->\n        <div>\n          <label>Name *</label>\n          <input v-model=\"name\" placeholder=\"Enter your full name\" required />\n\n          <label>Address *</label>\n          <input v-model=\"address\" placeholder=\"Enter your address\" required />\n\n          <label>Phone *</label>\n          <input v-model=\"phone\" placeholder=\"Enter phone number\" required />\n\n          <label>Password *</label>\n          <input\n            type=\"password\"\n            v-model=\"password\"\n            placeholder=\"Enter password\"\n            required\n          />\n        </div>\n\n        <!-- Right column -->\n        <div>\n          <label>Gender *</label>\n          <select v-model=\"gender\" required>\n            <option disabled value=\"\">Select gender</option>\n            <option value=\"male\">Male</option>\n            <option value=\"female\">Female</option>\n            <option value=\"other\">Other</option>\n          </select>\n\n          <label>Pincode *</label>\n          <input\n            v-model=\"pincode\"\n            placeholder=\"Enter postal pincode\"\n            required\n          />\n\n          <label>Profile Photo *</label>\n          <input type=\"file\" @change=\"onFileChange\" accept=\"image/*\" required />\n\n          <!-- Show preview -->\n          <div v-if=\"profilePhotoPreview\" class=\"preview\">\n            <img :src=\"profilePhotoPreview\" alt=\"Profile Preview\" />\n          </div>\n        </div>\n      </div>\n\n      <button type=\"submit\">Submit</button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      name: \"\",\n      address: \"\",\n      phone: \"\",\n      password: \"\",\n      gender: \"\",\n      pincode: \"\",\n      profilePhoto: null,\n      profilePhotoPreview: null,\n      message: \"\",\n      submitted: false, // track submission\n    };\n  },\n  mounted() {\n    // Check if token is valid and if user already submitted\n    this.checkTokenStatus();\n  },\n  methods: {\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.profilePhoto = file;\n        this.profilePhotoPreview = URL.createObjectURL(file);\n      }\n    },\n\n    async checkTokenStatus() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      try {\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/check-submitted\",\n          { token }\n        );\n        if (res.data.submitted) {\n          this.message = \"You have already submitted your registration.\";\n          this.submitted = true;\n        }\n      } catch (err) {\n        this.message = \"Invalid or expired link.\";\n        this.submitted = true;\n      }\n    },\n\n    async register() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      if (this.submitted) {\n        this.message = \"You have already submitted.\";\n        return;\n      }\n\n      try {\n        const formData = new FormData();\n        formData.append(\"token\", token);\n        formData.append(\"name\", this.name);\n        formData.append(\"address\", this.address);\n        formData.append(\"phone\", this.phone);\n        formData.append(\"password\", this.password);\n        formData.append(\"gender\", this.gender);\n        formData.append(\"pincode\", this.pincode);\n        formData.append(\"profilePhoto\", this.profilePhoto);\n\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/register\",\n          formData,\n          { headers: { \"Content-Type\": \"multipart/form-data\" } }\n        );\n\n        this.message = res.data.message || \"Registration successful!\";\n        this.submitted = true;\n\n        // Redirect if backend provides redirect URL\n        if (res.data.redirect) {\n          setTimeout(() => {\n            this.$router.push(res.data.redirect);\n          }, 2000);\n        }\n      } catch (err) {\n        if (err.response?.data?.alreadySubmitted) {\n          this.message = \"You have already submitted.\";\n          this.submitted = true;\n        } else {\n          this.message =\n            err.response?.data?.message || \"Error submitting registration\";\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.staff-register {\n  max-width: 800px;\n  margin: 30px auto;\n  padding: 30px;\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\nh2 {\n  text-align: center;\n  margin-bottom: 25px;\n  font-size: 24px;\n  color: #2d3748;\n}\n\n.message {\n  text-align: center;\n  font-weight: bold;\n  color: #4cafef;\n  margin-bottom: 15px;\n}\n\n.form-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 20px;\n}\n\nlabel {\n  display: block;\n  font-weight: 600;\n  margin-bottom: 6px;\n  color: #333;\n}\n\ninput,\nselect {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 15px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n  outline: none;\n  font-size: 14px;\n  transition: border 0.3s;\n}\n\ninput:focus,\nselect:focus {\n  border-color: #4cafef;\n}\n\nbutton {\n  margin-top: 15px;\n  width: 100%;\n  padding: 12px;\n  background: #4cafef;\n  color: #fff;\n  font-size: 16px;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: background 0.3s;\n}\n\nbutton:hover {\n  background: #3a9bdc;\n}\n\n.preview img {\n  margin-top: 10px;\n  max-width: 100px;\n  border-radius: 8px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}