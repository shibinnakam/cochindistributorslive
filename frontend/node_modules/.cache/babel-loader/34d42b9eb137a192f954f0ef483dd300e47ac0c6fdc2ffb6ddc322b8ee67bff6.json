{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      name: \"\",\n      address: \"\",\n      phone: \"\",\n      password: \"\",\n      gender: \"\",\n      pincode: \"\",\n      profilePhoto: null,\n      profilePhotoPreview: null,\n      message: \"\",\n      submitted: false,\n      errors: {} // Track field-specific errors\n    };\n  },\n  mounted() {\n    this.checkTokenStatus();\n  },\n  methods: {\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.profilePhoto = file;\n        this.profilePhotoPreview = URL.createObjectURL(file);\n      }\n    },\n    async checkTokenStatus() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n      try {\n        const res = await axios.post(\"http://localhost:5000/api/staff/check-submitted\", {\n          token\n        });\n        if (res.data.submitted) {\n          this.message = \"You have already submitted your registration.\";\n          this.submitted = true;\n        }\n      } catch (err) {\n        this.message = \"Invalid or expired link.\";\n        this.submitted = true;\n      }\n    },\n    async register() {\n      this.errors = {}; // Clear previous errors\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      // Frontend validations before submitting\n      if (!this.name.match(/^[a-zA-Z ]{3,50}$/)) {\n        this.errors.name = \"Name must be 3–50 letters only\";\n      }\n      if (!this.address || this.address.length < 5 || this.address.length > 100) {\n        this.errors.address = \"Address must be 5–100 characters\";\n      }\n      if (!this.phone.match(/^[6-9]\\d{9}$/)) {\n        this.errors.phone = \"Invalid Indian phone number\";\n      }\n      if (!this.pincode.match(/^[1-9]\\d{5}$/)) {\n        this.errors.pincode = \"Invalid Indian pincode\";\n      }\n      const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;\n      if (!this.password.match(passwordRegex)) {\n        this.errors.password = \"Password must be 8+ chars with uppercase, lowercase, number & special char\";\n      }\n      if (!this.gender) {\n        this.errors.gender = \"Please select gender\";\n      }\n      if (!this.profilePhoto) {\n        this.errors.profilePhoto = \"Profile photo is required\";\n      }\n      if (Object.keys(this.errors).length > 0) return; // Stop if errors\n\n      try {\n        const formData = new FormData();\n        formData.append(\"token\", token);\n        formData.append(\"name\", this.name);\n        formData.append(\"address\", this.address);\n        formData.append(\"phone\", this.phone);\n        formData.append(\"password\", this.password);\n        formData.append(\"gender\", this.gender);\n        formData.append(\"pincode\", this.pincode);\n        formData.append(\"profilePhoto\", this.profilePhoto);\n        const res = await axios.post(\"http://localhost:5000/api/staff/register\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.message = res.data.message || \"Registration successful!\";\n        this.submitted = true;\n        if (res.data.redirect) {\n          setTimeout(() => {\n            this.$router.push(res.data.redirect);\n          }, 2000);\n        }\n      } catch (err) {\n        if (err.response?.data?.alreadySubmitted) {\n          this.message = \"You have already submitted.\";\n          this.submitted = true;\n        } else {\n          this.message = err.response?.data?.message || \"Error submitting registration\";\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","name","address","phone","password","gender","pincode","profilePhoto","profilePhotoPreview","message","submitted","errors","mounted","checkTokenStatus","methods","onFileChange","e","file","target","files","URL","createObjectURL","token","$route","query","res","post","err","register","match","length","passwordRegex","Object","keys","formData","FormData","append","headers","redirect","setTimeout","$router","push","response","alreadySubmitted"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffRegister.vue"],"sourcesContent":["<template>\n  <div class=\"staff-register\">\n    <!-- Company Letterhead -->\n    <div class=\"letterhead\">\n      <img src=\"@/assets/logo.jpeg\" alt=\"Company Logo\" class=\"company-logo\" />\n      <h1 class=\"company-name\">Cochin Distributors</h1>\n    </div>\n\n    <h2>Complete Your Registration</h2>\n\n    <!-- Form disabled if submitted -->\n    <form\n      v-if=\"!submitted\"\n      @submit.prevent=\"register\"\n      enctype=\"multipart/form-data\"\n    >\n      <div class=\"form-grid\">\n        <!-- Left column -->\n        <div>\n          <label>Name *</label>\n          <input v-model=\"name\" placeholder=\"Enter your full name\" />\n          <p v-if=\"errors.name\" class=\"field-error\">{{ errors.name }}</p>\n\n          <label>Address *</label>\n          <textarea\n            v-model=\"address\"\n            placeholder=\"Enter your address\"\n            rows=\"3\"\n          ></textarea>\n          <p v-if=\"errors.address\" class=\"field-error\">{{ errors.address }}</p>\n\n          <label>Phone *</label>\n          <input v-model=\"phone\" placeholder=\"Enter phone number\" />\n          <p v-if=\"errors.phone\" class=\"field-error\">{{ errors.phone }}</p>\n\n          <label>Password *</label>\n          <input\n            type=\"password\"\n            v-model=\"password\"\n            placeholder=\"Enter password\"\n          />\n          <p v-if=\"errors.password\" class=\"field-error\">\n            {{ errors.password }}\n          </p>\n        </div>\n\n        <!-- Right column -->\n        <div>\n          <label>Gender *</label>\n          <select v-model=\"gender\">\n            <option disabled value=\"\">Select gender</option>\n            <option value=\"male\">Male</option>\n            <option value=\"female\">Female</option>\n            <option value=\"other\">Other</option>\n          </select>\n          <p v-if=\"errors.gender\" class=\"field-error\">{{ errors.gender }}</p>\n\n          <label>Pincode *</label>\n          <input v-model=\"pincode\" placeholder=\"Enter postal pincode\" />\n          <p v-if=\"errors.pincode\" class=\"field-error\">{{ errors.pincode }}</p>\n\n          <label>Profile Photo *</label>\n          <input type=\"file\" @change=\"onFileChange\" accept=\"image/*\" />\n          <p v-if=\"errors.profilePhoto\" class=\"field-error\">\n            {{ errors.profilePhoto }}\n          </p>\n\n          <!-- Show preview -->\n          <div v-if=\"profilePhotoPreview\" class=\"preview\">\n            <img :src=\"profilePhotoPreview\" alt=\"Profile Preview\" />\n          </div>\n        </div>\n      </div>\n\n      <button type=\"submit\">Submit</button>\n    </form>\n\n    <!-- Global message -->\n    <p v-if=\"message\" class=\"message\">{{ message }}</p>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      name: \"\",\n      address: \"\",\n      phone: \"\",\n      password: \"\",\n      gender: \"\",\n      pincode: \"\",\n      profilePhoto: null,\n      profilePhotoPreview: null,\n      message: \"\",\n      submitted: false,\n      errors: {}, // Track field-specific errors\n    };\n  },\n  mounted() {\n    this.checkTokenStatus();\n  },\n  methods: {\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.profilePhoto = file;\n        this.profilePhotoPreview = URL.createObjectURL(file);\n      }\n    },\n\n    async checkTokenStatus() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      try {\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/check-submitted\",\n          { token }\n        );\n        if (res.data.submitted) {\n          this.message = \"You have already submitted your registration.\";\n          this.submitted = true;\n        }\n      } catch (err) {\n        this.message = \"Invalid or expired link.\";\n        this.submitted = true;\n      }\n    },\n\n    async register() {\n      this.errors = {}; // Clear previous errors\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      // Frontend validations before submitting\n      if (!this.name.match(/^[a-zA-Z ]{3,50}$/)) {\n        this.errors.name = \"Name must be 3–50 letters only\";\n      }\n      if (\n        !this.address ||\n        this.address.length < 5 ||\n        this.address.length > 100\n      ) {\n        this.errors.address = \"Address must be 5–100 characters\";\n      }\n      if (!this.phone.match(/^[6-9]\\d{9}$/)) {\n        this.errors.phone = \"Invalid Indian phone number\";\n      }\n      if (!this.pincode.match(/^[1-9]\\d{5}$/)) {\n        this.errors.pincode = \"Invalid Indian pincode\";\n      }\n      const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;\n      if (!this.password.match(passwordRegex)) {\n        this.errors.password =\n          \"Password must be 8+ chars with uppercase, lowercase, number & special char\";\n      }\n      if (!this.gender) {\n        this.errors.gender = \"Please select gender\";\n      }\n      if (!this.profilePhoto) {\n        this.errors.profilePhoto = \"Profile photo is required\";\n      }\n\n      if (Object.keys(this.errors).length > 0) return; // Stop if errors\n\n      try {\n        const formData = new FormData();\n        formData.append(\"token\", token);\n        formData.append(\"name\", this.name);\n        formData.append(\"address\", this.address);\n        formData.append(\"phone\", this.phone);\n        formData.append(\"password\", this.password);\n        formData.append(\"gender\", this.gender);\n        formData.append(\"pincode\", this.pincode);\n        formData.append(\"profilePhoto\", this.profilePhoto);\n\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/register\",\n          formData,\n          { headers: { \"Content-Type\": \"multipart/form-data\" } }\n        );\n\n        this.message = res.data.message || \"Registration successful!\";\n        this.submitted = true;\n\n        if (res.data.redirect) {\n          setTimeout(() => {\n            this.$router.push(res.data.redirect);\n          }, 2000);\n        }\n      } catch (err) {\n        if (err.response?.data?.alreadySubmitted) {\n          this.message = \"You have already submitted.\";\n          this.submitted = true;\n        } else {\n          this.message =\n            err.response?.data?.message || \"Error submitting registration\";\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.staff-register {\n  max-width: 800px;\n  margin: 30px auto;\n  padding: 30px;\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n/* Letterhead styling */\n.letterhead {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  background: linear-gradient(\n    90deg,\n    #ffffffff 10%,\n    #130133ff 100%\n  ); /* Red + White */\n  padding: 15px 20px;\n  border-radius: 12px 12px 0 0;\n  margin-bottom: 25px;\n}\n\n.company-logo {\n  width: 90px;\n  height: 90px;\n  object-fit: contain;\n  margin-right: 20px;\n  border-radius: 0px;\n  border: 0px solid #ccc;\n}\n\n.company-name {\n  font-family: \"Times New Roman\", Times, serif;\n  font-size: 32px;\n  color: gold;\n  font-weight: bold;\n  margin: 0;\n}\n\n/* Form title */\nh2 {\n  text-align: center;\n  margin-bottom: 25px;\n  font-size: 24px;\n  color: #2d3748;\n}\n\n.field-error {\n  color: darkred;\n  font-size: 13px;\n  margin-top: -8px;\n  margin-bottom: 10px;\n}\n\n.message {\n  text-align: center;\n  font-weight: bold;\n  color: #4cafef;\n  margin-bottom: 15px;\n}\n\n/* Form grid: 2 columns with extra gap for spacing */\n.form-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  column-gap: 40px; /* horizontal spacing between left & right column */\n  row-gap: 15px; /* vertical spacing between rows */\n}\n\nlabel {\n  display: block;\n  font-weight: 600;\n  margin-bottom: 6px;\n  color: #333;\n}\n\ninput,\nselect,\ntextarea {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 15px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n  outline: none;\n  font-size: 14px;\n  transition: border 0.3s;\n}\n\ninput:focus,\nselect:focus,\ntextarea:focus {\n  border-color: #4cafef;\n}\n\nbutton {\n  margin-top: 15px;\n  width: 100%;\n  padding: 12px;\n  background: #022f4aff;\n  color: #fff;\n  font-size: 16px;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: background 0.3s;\n}\n\nbutton:hover {\n  background: #0a4c78ff;\n}\n\n.preview img {\n  margin-top: 10px;\n  max-width: 100px;\n  border-radius: 8px;\n}\n\n/* Optional: add spacing above each left/right column pair */\n.form-grid > div > label {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}