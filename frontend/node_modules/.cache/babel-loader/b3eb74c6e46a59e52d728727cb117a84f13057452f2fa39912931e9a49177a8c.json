{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\n/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { HAS_WEBXR_DEVICE_API, HAS_WEBXR_HIT_TEST_API, IS_WEBXR_AR_CANDIDATE } from './constants.js';\nexport const deserializeUrl = url => !!url && url !== 'null' ? toFullUrl(url) : null;\nexport const assertIsArCandidate = () => {\n  if (IS_WEBXR_AR_CANDIDATE) {\n    return;\n  }\n  const missingApis = [];\n  if (!HAS_WEBXR_DEVICE_API) {\n    missingApis.push('WebXR Device API');\n  }\n  if (!HAS_WEBXR_HIT_TEST_API) {\n    missingApis.push('WebXR Hit Test API');\n  }\n  throw new Error(`The following APIs are required for AR, but are missing in this browser: ${missingApis.join(', ')}`);\n};\n/**\n * Converts a partial URL string to a fully qualified URL string.\n *\n * @param {String} url\n * @return {String}\n */\nexport const toFullUrl = partialUrl => {\n  const url = new URL(partialUrl, window.location.toString());\n  return url.toString();\n};\n/**\n * Returns a throttled version of a given function that is only invoked at most\n * once within a given threshold of time in milliseconds.\n *\n * The throttled version of the function has a \"flush\" property that resets the\n * threshold for cases when immediate invocation is desired.\n */\nexport const throttle = (fn, ms) => {\n  let timer = null;\n  const throttled = (...args) => {\n    if (timer != null) {\n      return;\n    }\n    fn(...args);\n    timer = self.setTimeout(() => timer = null, ms);\n  };\n  throttled.flush = () => {\n    if (timer != null) {\n      self.clearTimeout(timer);\n      timer = null;\n    }\n  };\n  return throttled;\n};\nexport const debounce = (fn, ms) => {\n  let timer = null;\n  return (...args) => {\n    if (timer != null) {\n      self.clearTimeout(timer);\n    }\n    timer = self.setTimeout(() => {\n      timer = null;\n      fn(...args);\n    }, ms);\n  };\n};\n/**\n * @param {Number} edge\n * @param {Number} value\n * @return {Number} 0 if value is less than edge, otherwise 1\n */\nexport const step = (edge, value) => {\n  return value < edge ? 0 : 1;\n};\n/**\n * @param {Number} value\n * @param {Number} lowerLimit\n * @param {Number} upperLimit\n * @return {Number} value clamped within lowerLimit..upperLimit\n */\nexport const clamp = (value, lowerLimit, upperLimit) => Math.max(lowerLimit, Math.min(upperLimit, value));\n/**\n * Debug mode is enabled when one of the two following conditions is true:\n *\n *  1. A 'model-viewer-debug-mode' query parameter is present in the current\n *     search string\n *  2. There is a global object ModelViewerElement with a debugMode property set\n *     to true\n */\nexport const isDebugMode = (() => {\n  const debugQueryParameterName = 'model-viewer-debug-mode';\n  const debugQueryParameter = new RegExp(`[?&]${debugQueryParameterName}(&|$)`);\n  return () => self.ModelViewerElement && self.ModelViewerElement.debugMode || self.location && self.location.search && self.location.search.match(debugQueryParameter);\n})();\nexport const timePasses = (ms = 0) => new Promise(resolve => setTimeout(resolve, ms));\n/**\n * @param {EventTarget|EventDispatcher} target\n * @param {string} eventName\n * @param {?Function} predicate\n */\nexport const waitForEvent = (target, eventName, predicate = null) => new Promise(resolve => {\n  function handler(event) {\n    if (!predicate || predicate(event)) {\n      resolve(event);\n      target.removeEventListener(eventName, handler);\n    }\n  }\n  target.addEventListener(eventName, handler);\n});","map":{"version":3,"names":["HAS_WEBXR_DEVICE_API","HAS_WEBXR_HIT_TEST_API","IS_WEBXR_AR_CANDIDATE","deserializeUrl","url","toFullUrl","assertIsArCandidate","missingApis","push","Error","join","partialUrl","URL","window","location","toString","throttle","fn","ms","timer","throttled","args","self","setTimeout","flush","clearTimeout","debounce","step","edge","value","clamp","lowerLimit","upperLimit","Math","max","min","isDebugMode","debugQueryParameterName","debugQueryParameter","RegExp","ModelViewerElement","debugMode","search","match","timePasses","Promise","resolve","waitForEvent","target","eventName","predicate","handler","event","removeEventListener","addEventListener"],"sources":["../src/utilities.ts"],"sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {HAS_WEBXR_DEVICE_API, HAS_WEBXR_HIT_TEST_API, IS_WEBXR_AR_CANDIDATE} from './constants.js';\n\nexport type Constructor<T = object, U = object> = {\n  new (...args: any[]): T,\n  prototype: T\n}&U;\n\nexport const deserializeUrl = (url: string|null): string|null =>\n    (!!url && url !== 'null') ? toFullUrl(url) : null;\n\n\nexport const assertIsArCandidate = () => {\n  if (IS_WEBXR_AR_CANDIDATE) {\n    return;\n  }\n\n  const missingApis = [];\n\n  if (!HAS_WEBXR_DEVICE_API) {\n    missingApis.push('WebXR Device API');\n  }\n\n  if (!HAS_WEBXR_HIT_TEST_API) {\n    missingApis.push('WebXR Hit Test API');\n  }\n\n  throw new Error(\n      `The following APIs are required for AR, but are missing in this browser: ${\n          missingApis.join(', ')}`);\n};\n\n\n/**\n * Converts a partial URL string to a fully qualified URL string.\n *\n * @param {String} url\n * @return {String}\n */\nexport const toFullUrl = (partialUrl: string): string => {\n  const url = new URL(partialUrl, window.location.toString());\n  return url.toString();\n};\n\n\n/**\n * Returns a throttled version of a given function that is only invoked at most\n * once within a given threshold of time in milliseconds.\n *\n * The throttled version of the function has a \"flush\" property that resets the\n * threshold for cases when immediate invocation is desired.\n */\nexport const throttle = (fn: (...args: Array<any>) => any, ms: number) => {\n  let timer: number|null = null;\n\n  const throttled = (...args: Array<any>) => {\n    if (timer != null) {\n      return;\n    }\n\n    fn(...args);\n\n    timer = self.setTimeout(() => timer = null, ms);\n  };\n\n  throttled.flush = () => {\n    if (timer != null) {\n      self.clearTimeout(timer);\n      timer = null;\n    }\n  };\n\n  return throttled;\n};\n\nexport const debounce = (fn: (...args: Array<any>) => any, ms: number) => {\n  let timer: number|null = null;\n\n  return (...args: Array<any>) => {\n    if (timer != null) {\n      self.clearTimeout(timer);\n    }\n\n    timer = self.setTimeout(() => {\n      timer = null;\n      fn(...args);\n    }, ms);\n  };\n};\n\n\n/**\n * @param {Number} edge\n * @param {Number} value\n * @return {Number} 0 if value is less than edge, otherwise 1\n */\nexport const step = (edge: number, value: number): number => {\n  return value < edge ? 0 : 1;\n};\n\n\n/**\n * @param {Number} value\n * @param {Number} lowerLimit\n * @param {Number} upperLimit\n * @return {Number} value clamped within lowerLimit..upperLimit\n */\nexport const clamp =\n    (value: number, lowerLimit: number, upperLimit: number): number =>\n        Math.max(lowerLimit, Math.min(upperLimit, value));\n\n/**\n * Debug mode is enabled when one of the two following conditions is true:\n *\n *  1. A 'model-viewer-debug-mode' query parameter is present in the current\n *     search string\n *  2. There is a global object ModelViewerElement with a debugMode property set\n *     to true\n */\nexport const isDebugMode = (() => {\n  const debugQueryParameterName = 'model-viewer-debug-mode';\n  const debugQueryParameter = new RegExp(`[?&]${debugQueryParameterName}(&|$)`);\n\n  return () => ((self as any).ModelViewerElement &&\n                (self as any).ModelViewerElement.debugMode) ||\n      (self.location && self.location.search &&\n       self.location.search.match(debugQueryParameter));\n})();\n\nexport type PredicateFunction<T = void> = (value: T) => boolean;\n\nexport const timePasses = (ms: number = 0): Promise<void> =>\n    new Promise(resolve => setTimeout(resolve, ms));\n\n/**\n * @param {EventTarget|EventDispatcher} target\n * @param {string} eventName\n * @param {?Function} predicate\n */\nexport const waitForEvent =\n    <T>(target: any,\n        eventName: string,\n        predicate: PredicateFunction<T>|null = null): Promise<T> =>\n        new Promise(resolve => {\n          function handler(event: T) {\n            if (!predicate || predicate(event)) {\n              resolve(event);\n              target.removeEventListener(eventName, handler);\n            }\n          }\n          target.addEventListener(eventName, handler);\n        });"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}