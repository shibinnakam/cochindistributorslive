{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"staff-register\"\n};\nconst _hoisted_2 = {\n  class: \"form-grid\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"field-error\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"field-error\"\n};\nconst _hoisted_5 = {\n  key: 2,\n  class: \"field-error\"\n};\nconst _hoisted_6 = {\n  key: 3,\n  class: \"field-error\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"field-error\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  class: \"field-error\"\n};\nconst _hoisted_9 = {\n  key: 2,\n  class: \"field-error\"\n};\nconst _hoisted_10 = {\n  key: 3,\n  class: \"preview\"\n};\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = {\n  key: 1,\n  class: \"message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[17] || (_cache[17] = _createElementVNode(\"h2\", null, \"Complete Your Registration\", -1 /* CACHED */)), _createCommentVNode(\" Form disabled if submitted \"), !$data.submitted ? (_openBlock(), _createElementBlock(\"form\", {\n    key: 0,\n    onSubmit: _cache[7] || (_cache[7] = _withModifiers((...args) => $options.register && $options.register(...args), [\"prevent\"])),\n    enctype: \"multipart/form-data\"\n  }, [_createElementVNode(\"div\", _hoisted_2, [_createCommentVNode(\" Left column \"), _createElementVNode(\"div\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", null, \"Name *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.name = $event),\n    placeholder: \"Enter your full name\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.name]]), $data.errors.name ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, _toDisplayString($data.errors.name), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[9] || (_cache[9] = _createElementVNode(\"label\", null, \"Address *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.address = $event),\n    placeholder: \"Enter your address\",\n    rows: \"3\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.address]]), $data.errors.address ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString($data.errors.address), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[10] || (_cache[10] = _createElementVNode(\"label\", null, \"Phone *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.phone = $event),\n    placeholder: \"Enter phone number\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.phone]]), $data.errors.phone ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($data.errors.phone), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[11] || (_cache[11] = _createElementVNode(\"label\", null, \"Password *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.password = $event),\n    placeholder: \"Enter password\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password]]), $data.errors.password ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, _toDisplayString($data.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" Right column \"), _createElementVNode(\"div\", null, [_cache[13] || (_cache[13] = _createElementVNode(\"label\", null, \"Gender *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.gender = $event)\n  }, _cache[12] || (_cache[12] = [_createElementVNode(\"option\", {\n    disabled: \"\",\n    value: \"\"\n  }, \"Select gender\", -1 /* CACHED */), _createElementVNode(\"option\", {\n    value: \"male\"\n  }, \"Male\", -1 /* CACHED */), _createElementVNode(\"option\", {\n    value: \"female\"\n  }, \"Female\", -1 /* CACHED */), _createElementVNode(\"option\", {\n    value: \"other\"\n  }, \"Other\", -1 /* CACHED */)]), 512 /* NEED_PATCH */), [[_vModelSelect, $data.gender]]), $data.errors.gender ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString($data.errors.gender), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[14] || (_cache[14] = _createElementVNode(\"label\", null, \"Pincode *\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $data.pincode = $event),\n    placeholder: \"Enter postal pincode\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.pincode]]), $data.errors.pincode ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, _toDisplayString($data.errors.pincode), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _cache[15] || (_cache[15] = _createElementVNode(\"label\", null, \"Profile Photo *\", -1 /* CACHED */)), _createElementVNode(\"input\", {\n    type: \"file\",\n    onChange: _cache[6] || (_cache[6] = (...args) => $options.onFileChange && $options.onFileChange(...args)),\n    accept: \"image/*\"\n  }, null, 32 /* NEED_HYDRATION */), $data.errors.profilePhoto ? (_openBlock(), _createElementBlock(\"p\", _hoisted_9, _toDisplayString($data.errors.profilePhoto), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Show preview \"), $data.profilePhotoPreview ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_createElementVNode(\"img\", {\n    src: $data.profilePhotoPreview,\n    alt: \"Profile Preview\"\n  }, null, 8 /* PROPS */, _hoisted_11)])) : _createCommentVNode(\"v-if\", true)])]), _cache[16] || (_cache[16] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"Submit\", -1 /* CACHED */))], 32 /* NEED_HYDRATION */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Global message \"), $data.message ? (_openBlock(), _createElementBlock(\"p\", _hoisted_12, _toDisplayString($data.message), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","$data","submitted","onSubmit","_cache","_withModifiers","args","$options","register","enctype","_hoisted_2","name","$event","placeholder","errors","_hoisted_3","_toDisplayString","address","rows","_hoisted_4","phone","_hoisted_5","type","password","_hoisted_6","gender","disabled","value","_hoisted_7","pincode","_hoisted_8","onChange","onFileChange","accept","profilePhoto","_hoisted_9","profilePhotoPreview","_hoisted_10","src","alt","message","_hoisted_12"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffRegister.vue"],"sourcesContent":["<template>\n  <div class=\"staff-register\">\n    <h2>Complete Your Registration</h2>\n\n    <!-- Form disabled if submitted -->\n    <form\n      v-if=\"!submitted\"\n      @submit.prevent=\"register\"\n      enctype=\"multipart/form-data\"\n    >\n      <div class=\"form-grid\">\n        <!-- Left column -->\n        <div>\n          <label>Name *</label>\n          <input v-model=\"name\" placeholder=\"Enter your full name\" />\n          <p v-if=\"errors.name\" class=\"field-error\">{{ errors.name }}</p>\n\n          <label>Address *</label>\n          <textarea\n            v-model=\"address\"\n            placeholder=\"Enter your address\"\n            rows=\"3\"\n          ></textarea>\n          <p v-if=\"errors.address\" class=\"field-error\">{{ errors.address }}</p>\n\n          <label>Phone *</label>\n          <input v-model=\"phone\" placeholder=\"Enter phone number\" />\n          <p v-if=\"errors.phone\" class=\"field-error\">{{ errors.phone }}</p>\n\n          <label>Password *</label>\n          <input\n            type=\"password\"\n            v-model=\"password\"\n            placeholder=\"Enter password\"\n          />\n          <p v-if=\"errors.password\" class=\"field-error\">\n            {{ errors.password }}\n          </p>\n        </div>\n\n        <!-- Right column -->\n        <div>\n          <label>Gender *</label>\n          <select v-model=\"gender\">\n            <option disabled value=\"\">Select gender</option>\n            <option value=\"male\">Male</option>\n            <option value=\"female\">Female</option>\n            <option value=\"other\">Other</option>\n          </select>\n          <p v-if=\"errors.gender\" class=\"field-error\">{{ errors.gender }}</p>\n\n          <label>Pincode *</label>\n          <input v-model=\"pincode\" placeholder=\"Enter postal pincode\" />\n          <p v-if=\"errors.pincode\" class=\"field-error\">{{ errors.pincode }}</p>\n\n          <label>Profile Photo *</label>\n          <input type=\"file\" @change=\"onFileChange\" accept=\"image/*\" />\n          <p v-if=\"errors.profilePhoto\" class=\"field-error\">\n            {{ errors.profilePhoto }}\n          </p>\n\n          <!-- Show preview -->\n          <div v-if=\"profilePhotoPreview\" class=\"preview\">\n            <img :src=\"profilePhotoPreview\" alt=\"Profile Preview\" />\n          </div>\n        </div>\n      </div>\n\n      <button type=\"submit\">Submit</button>\n    </form>\n\n    <!-- Global message -->\n    <p v-if=\"message\" class=\"message\">{{ message }}</p>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      name: \"\",\n      address: \"\",\n      phone: \"\",\n      password: \"\",\n      gender: \"\",\n      pincode: \"\",\n      profilePhoto: null,\n      profilePhotoPreview: null,\n      message: \"\",\n      submitted: false,\n      errors: {}, // Track field-specific errors\n    };\n  },\n  mounted() {\n    this.checkTokenStatus();\n  },\n  methods: {\n    onFileChange(e) {\n      const file = e.target.files[0];\n      if (file) {\n        this.profilePhoto = file;\n        this.profilePhotoPreview = URL.createObjectURL(file);\n      }\n    },\n\n    async checkTokenStatus() {\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      try {\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/check-submitted\",\n          { token }\n        );\n        if (res.data.submitted) {\n          this.message = \"You have already submitted your registration.\";\n          this.submitted = true;\n        }\n      } catch (err) {\n        this.message = \"Invalid or expired link.\";\n        this.submitted = true;\n      }\n    },\n\n    async register() {\n      this.errors = {}; // Clear previous errors\n      const token = this.$route.query.token;\n      if (!token) {\n        this.message = \"Invalid or expired link\";\n        this.submitted = true;\n        return;\n      }\n\n      // Frontend validations before submitting\n      if (!this.name.match(/^[a-zA-Z ]{3,50}$/)) {\n        this.errors.name = \"Name must be 3–50 letters only\";\n      }\n      if (\n        !this.address ||\n        this.address.length < 5 ||\n        this.address.length > 100\n      ) {\n        this.errors.address = \"Address must be 5–100 characters\";\n      }\n      if (!this.phone.match(/^[6-9]\\d{9}$/)) {\n        this.errors.phone = \"Invalid Indian phone number\";\n      }\n      if (!this.pincode.match(/^[1-9]\\d{5}$/)) {\n        this.errors.pincode = \"Invalid Indian pincode\";\n      }\n      const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{8,}$/;\n      if (!this.password.match(passwordRegex)) {\n        this.errors.password =\n          \"Password must be 8+ chars with uppercase, lowercase, number & special char\";\n      }\n      if (!this.gender) {\n        this.errors.gender = \"Please select gender\";\n      }\n      if (!this.profilePhoto) {\n        this.errors.profilePhoto = \"Profile photo is required\";\n      }\n\n      if (Object.keys(this.errors).length > 0) return; // Stop if errors\n\n      try {\n        const formData = new FormData();\n        formData.append(\"token\", token);\n        formData.append(\"name\", this.name);\n        formData.append(\"address\", this.address);\n        formData.append(\"phone\", this.phone);\n        formData.append(\"password\", this.password);\n        formData.append(\"gender\", this.gender);\n        formData.append(\"pincode\", this.pincode);\n        formData.append(\"profilePhoto\", this.profilePhoto);\n\n        const res = await axios.post(\n          \"http://localhost:5000/api/staff/register\",\n          formData,\n          { headers: { \"Content-Type\": \"multipart/form-data\" } }\n        );\n\n        this.message = res.data.message || \"Registration successful!\";\n        this.submitted = true;\n\n        if (res.data.redirect) {\n          setTimeout(() => {\n            this.$router.push(res.data.redirect);\n          }, 2000);\n        }\n      } catch (err) {\n        if (err.response?.data?.alreadySubmitted) {\n          this.message = \"You have already submitted.\";\n          this.submitted = true;\n        } else {\n          this.message =\n            err.response?.data?.message || \"Error submitting registration\";\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.staff-register {\n  max-width: 800px;\n  margin: 30px auto;\n  padding: 30px;\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\nh2 {\n  text-align: center;\n  margin-bottom: 25px;\n  font-size: 24px;\n  color: #2d3748;\n}\n\n.field-error {\n  color: darkred;\n  font-size: 13px;\n  margin-top: -8px;\n  margin-bottom: 10px;\n}\n\n.message {\n  text-align: center;\n  font-weight: bold;\n  color: #4cafef;\n  margin-bottom: 15px;\n}\n\n/* Form grid: 2 columns with extra gap for spacing */\n.form-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  column-gap: 40px; /* horizontal spacing between left & right column */\n  row-gap: 15px; /* vertical spacing between rows */\n}\n\nlabel {\n  display: block;\n  font-weight: 600;\n  margin-bottom: 6px;\n  color: #333;\n}\n\ninput,\nselect,\ntextarea {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 15px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n  outline: none;\n  font-size: 14px;\n  transition: border 0.3s;\n}\n\ninput:focus,\nselect:focus,\ntextarea:focus {\n  border-color: #4cafef;\n}\n\nbutton {\n  margin-top: 15px;\n  width: 100%;\n  padding: 12px;\n  background: #021b2cff;\n  color: #fff;\n  font-size: 16px;\n  border: none;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: background 0.3s;\n}\n\nbutton:hover {\n  background: #3a9bdc;\n}\n\n.preview img {\n  margin-top: 10px;\n  max-width: 100px;\n  border-radius: 8px;\n}\n\n/* Optional: add spacing above each left/right column pair */\n.form-grid > div > label {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}