{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nexport default {\n  name: \"ProfilePage\",\n  data() {\n    return {\n      user: {\n        email: \"\",\n        name: \"\",\n        phone: \"\",\n        storeName: \"\",\n        storeAddress: \"\",\n        pincode: \"\",\n        landmark: \"\",\n        hasPassword: false\n      },\n      passwordForm: {\n        currentPassword: \"\",\n        newPassword: \"\",\n        confirmPassword: \"\"\n      },\n      loading: true,\n      updating: false,\n      passwordUpdating: false\n    };\n  },\n  mounted() {\n    this.fetchProfile();\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        if (!token) {\n          this.$router.push(\"/login\");\n          return;\n        }\n        const res = await axios.get(\"http://localhost:5000/api/auth/profile\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.user = res.data.user;\n      } catch (err) {\n        console.error(\"Error fetching profile:\", err);\n        alert(\"Failed to load profile\");\n      } finally {\n        this.loading = false;\n      }\n    },\n    async updateProfile() {\n      this.updating = true;\n      try {\n        const token = localStorage.getItem(\"token\");\n        await axios.put(\"http://localhost:5000/api/auth/profile\", this.user, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert(\"Profile updated successfully!\");\n      } catch (err) {\n        console.error(\"Error updating profile:\", err);\n        alert(\"Failed to update profile\");\n      } finally {\n        this.updating = false;\n      }\n    },\n    async changePassword() {\n      if (this.passwordForm.newPassword !== this.passwordForm.confirmPassword) {\n        alert(\"New passwords do not match\");\n        return;\n      }\n      this.passwordUpdating = true;\n      try {\n        const token = localStorage.getItem(\"token\");\n\n        // If user has no password (Google login), we use set-password endpoint or handle it in change-password\n        // My backend change-password handles both if I tweak it, but currently it requires currentPassword if user.password exists.\n        // If user.hasPassword is false, currentPassword is not shown in form, so it will be empty.\n        // Backend logic: if (user.password) check currentPassword.\n        // So if user.password is null (Google user), it skips check.\n        // Wait, my backend logic was: if (user.password) { ... }\n        // So if user.password is missing, it skips current password check. This is correct for Google users setting password for first time.\n\n        await axios.post(\"http://localhost:5000/api/auth/change-password\", {\n          currentPassword: this.passwordForm.currentPassword,\n          newPassword: this.passwordForm.newPassword\n        }, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert(\"Password updated successfully!\");\n        this.passwordForm = {\n          currentPassword: \"\",\n          newPassword: \"\",\n          confirmPassword: \"\"\n        };\n        this.user.hasPassword = true; // Now they have a password\n      } catch (err) {\n        console.error(\"Error changing password:\", err);\n        alert(err.response?.data?.msg || \"Failed to update password\");\n      } finally {\n        this.passwordUpdating = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","user","email","phone","storeName","storeAddress","pincode","landmark","hasPassword","passwordForm","currentPassword","newPassword","confirmPassword","loading","updating","passwordUpdating","mounted","fetchProfile","methods","token","localStorage","getItem","$router","push","res","get","headers","Authorization","err","console","error","alert","updateProfile","put","changePassword","post","response","msg"],"sources":["C:\\Users\\LENOVO\\Music\\OneDrive\\Pictures\\distribution-agency-project\\frontend\\src\\views\\ProfilePage.vue"],"sourcesContent":["<template>\n  <div class=\"profile-container\">\n    <div class=\"profile-card\">\n      <h2>My Profile</h2>\n\n      <div v-if=\"loading\" class=\"loading\">Loading...</div>\n      <div v-else>\n        <!-- Profile Form -->\n        <form @submit.prevent=\"updateProfile\" class=\"profile-form\">\n          <div class=\"form-group\">\n            <label>Email (Read-only)</label>\n            <input\n              type=\"email\"\n              v-model=\"user.email\"\n              disabled\n              class=\"disabled-input\"\n            />\n          </div>\n\n          <div class=\"form-group\">\n            <label>Full Name</label>\n            <input\n              type=\"text\"\n              v-model=\"user.name\"\n              placeholder=\"Enter your name\"\n            />\n          </div>\n\n          <div class=\"form-group\">\n            <label>Contact Number</label>\n            <input\n              type=\"text\"\n              v-model=\"user.phone\"\n              placeholder=\"Phone number\"\n            />\n          </div>\n\n          <div class=\"form-group\">\n            <label>Shop Name</label>\n            <input\n              type=\"text\"\n              v-model=\"user.storeName\"\n              placeholder=\"Shop Name\"\n            />\n          </div>\n\n          <div class=\"form-group\">\n            <label>Shop Address</label>\n            <textarea\n              v-model=\"user.storeAddress\"\n              placeholder=\"Address\"\n            ></textarea>\n          </div>\n\n          <div class=\"form-row\">\n            <div class=\"form-group\">\n              <label>Pincode</label>\n              <input type=\"text\" v-model=\"user.pincode\" placeholder=\"Pincode\" />\n            </div>\n            <div class=\"form-group\">\n              <label>Landmark</label>\n              <input\n                type=\"text\"\n                v-model=\"user.landmark\"\n                placeholder=\"Landmark\"\n              />\n            </div>\n          </div>\n\n          <button type=\"submit\" class=\"btn-primary\" :disabled=\"updating\">\n            {{ updating ? \"Saving...\" : \"Save Changes\" }}\n          </button>\n        </form>\n\n        <hr class=\"divider\" />\n\n        <!-- Password Section -->\n        <div class=\"password-section\">\n          <h3>{{ user.hasPassword ? \"Change Password\" : \"Set Password\" }}</h3>\n\n          <form @submit.prevent=\"changePassword\">\n            <div v-if=\"user.hasPassword\" class=\"form-group\">\n              <label>Current Password</label>\n              <input\n                type=\"password\"\n                v-model=\"passwordForm.currentPassword\"\n                required\n              />\n            </div>\n\n            <div class=\"form-group\">\n              <label>New Password</label>\n              <input\n                type=\"password\"\n                v-model=\"passwordForm.newPassword\"\n                required\n              />\n            </div>\n\n            <div class=\"form-group\">\n              <label>Confirm New Password</label>\n              <input\n                type=\"password\"\n                v-model=\"passwordForm.confirmPassword\"\n                required\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              class=\"btn-secondary\"\n              :disabled=\"passwordUpdating\"\n            >\n              {{\n                passwordUpdating\n                  ? \"Updating...\"\n                  : user.hasPassword\n                  ? \"Change Password\"\n                  : \"Set Password\"\n              }}\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"ProfilePage\",\n  data() {\n    return {\n      user: {\n        email: \"\",\n        name: \"\",\n        phone: \"\",\n        storeName: \"\",\n        storeAddress: \"\",\n        pincode: \"\",\n        landmark: \"\",\n        hasPassword: false,\n      },\n      passwordForm: {\n        currentPassword: \"\",\n        newPassword: \"\",\n        confirmPassword: \"\",\n      },\n      loading: true,\n      updating: false,\n      passwordUpdating: false,\n    };\n  },\n  mounted() {\n    this.fetchProfile();\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        if (!token) {\n          this.$router.push(\"/login\");\n          return;\n        }\n        const res = await axios.get(\"http://localhost:5000/api/auth/profile\", {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        this.user = res.data.user;\n      } catch (err) {\n        console.error(\"Error fetching profile:\", err);\n        alert(\"Failed to load profile\");\n      } finally {\n        this.loading = false;\n      }\n    },\n    async updateProfile() {\n      this.updating = true;\n      try {\n        const token = localStorage.getItem(\"token\");\n        await axios.put(\"http://localhost:5000/api/auth/profile\", this.user, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        alert(\"Profile updated successfully!\");\n      } catch (err) {\n        console.error(\"Error updating profile:\", err);\n        alert(\"Failed to update profile\");\n      } finally {\n        this.updating = false;\n      }\n    },\n    async changePassword() {\n      if (this.passwordForm.newPassword !== this.passwordForm.confirmPassword) {\n        alert(\"New passwords do not match\");\n        return;\n      }\n\n      this.passwordUpdating = true;\n      try {\n        const token = localStorage.getItem(\"token\");\n\n        // If user has no password (Google login), we use set-password endpoint or handle it in change-password\n        // My backend change-password handles both if I tweak it, but currently it requires currentPassword if user.password exists.\n        // If user.hasPassword is false, currentPassword is not shown in form, so it will be empty.\n        // Backend logic: if (user.password) check currentPassword.\n        // So if user.password is null (Google user), it skips check.\n        // Wait, my backend logic was: if (user.password) { ... }\n        // So if user.password is missing, it skips current password check. This is correct for Google users setting password for first time.\n\n        await axios.post(\n          \"http://localhost:5000/api/auth/change-password\",\n          {\n            currentPassword: this.passwordForm.currentPassword,\n            newPassword: this.passwordForm.newPassword,\n          },\n          {\n            headers: { Authorization: `Bearer ${token}` },\n          }\n        );\n\n        alert(\"Password updated successfully!\");\n        this.passwordForm = {\n          currentPassword: \"\",\n          newPassword: \"\",\n          confirmPassword: \"\",\n        };\n        this.user.hasPassword = true; // Now they have a password\n      } catch (err) {\n        console.error(\"Error changing password:\", err);\n        alert(err.response?.data?.msg || \"Failed to update password\");\n      } finally {\n        this.passwordUpdating = false;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.profile-container {\n  display: flex;\n  justify-content: center;\n  padding: 40px 20px;\n  background-color: #f1f3f6;\n  min-height: 100vh;\n}\n\n.profile-card {\n  background: white;\n  padding: 30px;\n  border-radius: 4px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  width: 100%;\n  max-width: 600px;\n}\n\nh2,\nh3 {\n  color: #2874f0;\n  margin-bottom: 20px;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.form-row {\n  display: flex;\n  gap: 15px;\n}\n\n.form-row .form-group {\n  flex: 1;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: 500;\n  color: #333;\n}\n\ninput,\ntextarea {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 14px;\n}\n\ntextarea {\n  resize: vertical;\n  min-height: 80px;\n}\n\n.disabled-input {\n  background-color: #f9f9f9;\n  color: #777;\n  cursor: not-allowed;\n}\n\n.btn-primary {\n  background-color: #2874f0;\n  color: white;\n  border: none;\n  padding: 12px 20px;\n  border-radius: 2px;\n  cursor: pointer;\n  font-weight: bold;\n  width: 100%;\n  margin-top: 10px;\n}\n\n.btn-primary:hover {\n  background-color: #0056b3;\n}\n\n.divider {\n  margin: 30px 0;\n  border: 0;\n  border-top: 1px solid #eee;\n}\n\n.btn-secondary {\n  background-color: #fb641b;\n  color: white;\n  border: none;\n  padding: 12px 20px;\n  border-radius: 2px;\n  cursor: pointer;\n  font-weight: bold;\n  width: 100%;\n  margin-top: 10px;\n}\n\n.btn-secondary:hover {\n  background-color: #e05c15;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}