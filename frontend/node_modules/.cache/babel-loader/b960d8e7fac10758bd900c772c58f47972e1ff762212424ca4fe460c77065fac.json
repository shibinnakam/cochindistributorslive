{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport axios from \"axios\";\nimport StaffLeave from \"./StaffLeave.vue\";\nexport default {\n  components: {\n    StaffLeave\n  },\n  data() {\n    return {\n      currentTab: \"dashboard\",\n      showLeaves: false,\n      staff: {\n        name: \"\",\n        email: \"\",\n        phone: \"\",\n        gender: \"\",\n        address: \"\",\n        pincode: \"\",\n        profilePhoto: \"\"\n      },\n      stats: {\n        totalItems: 0,\n        leavesTaken: 0,\n        pendingTasks: 0,\n        completedTasks: 0\n      },\n      leaveStatus: [],\n      selectedFile: null,\n      message: \"\",\n      apiBase: \"http://localhost:5000\",\n      defaultPhoto: \"/default-avatar.png\"\n    };\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/staff/me`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.staff = res.data.staff;\n      } catch {\n        this.message = \"Error loading profile\";\n      }\n    },\n    async fetchStats() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/staff/stats`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.stats = res.data;\n      } catch (err) {\n        console.error(\"Error fetching stats\", err);\n      }\n    },\n    onFileChange(e) {\n      this.selectedFile = e.target.files[0];\n    },\n    async updateProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const formData = new FormData();\n        Object.keys(this.staff).forEach(key => {\n          if (key !== \"email\") formData.append(key, this.staff[key]);\n        });\n        if (this.selectedFile) formData.append(\"profilePhoto\", this.selectedFile);\n        const res = await axios.put(`${this.apiBase}/api/staff/update`, formData, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.message = res.data.message;\n        this.fetchProfile();\n      } catch (err) {\n        this.message = err.response?.data?.message || \"Error updating profile\";\n      }\n    },\n    toggleLeaves() {\n      this.showLeaves = !this.showLeaves;\n    },\n    logout() {\n      localStorage.removeItem(\"token\");\n      this.$router.push(\"/login\");\n    },\n    async fetchLeaveStatus() {\n      try {\n        const user = JSON.parse(localStorage.getItem(\"user\"));\n        const email = user?.email;\n        if (!email) return;\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/leaves/my`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          },\n          params: {\n            email\n          }\n        });\n        this.leaveStatus = res.data;\n      } catch (err) {\n        console.error(\"Error fetching leave status\", err);\n      }\n    },\n    formatDate(dateStr) {\n      return new Date(dateStr).toLocaleDateString();\n    }\n  },\n  watch: {\n    currentTab(newTab) {\n      if (newTab === \"leave-status\") this.fetchLeaveStatus();\n    }\n  },\n  mounted() {\n    this.fetchProfile();\n    this.fetchStats();\n  }\n};","map":{"version":3,"names":["axios","StaffLeave","components","data","currentTab","showLeaves","staff","name","email","phone","gender","address","pincode","profilePhoto","stats","totalItems","leavesTaken","pendingTasks","completedTasks","leaveStatus","selectedFile","message","apiBase","defaultPhoto","methods","fetchProfile","token","localStorage","getItem","res","get","headers","Authorization","fetchStats","err","console","error","onFileChange","e","target","files","updateProfile","formData","FormData","Object","keys","forEach","key","append","put","response","toggleLeaves","logout","removeItem","$router","push","fetchLeaveStatus","user","JSON","parse","params","formatDate","dateStr","Date","toLocaleDateString","watch","newTab","mounted"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffPage.vue"],"sourcesContent":["<template>\n  <div class=\"staff-dashboard\">\n    <!-- Sidebar -->\n    <aside class=\"sidebar\">\n      <h2 class=\"sidebar-title\">Staff Panel</h2>\n      <ul>\n        <li\n          :class=\"{ active: currentTab === 'dashboard' }\"\n          @click=\"currentTab = 'dashboard'\"\n        >\n          Dashboard\n        </li>\n        <li\n          :class=\"{ active: currentTab === 'profile' }\"\n          @click=\"currentTab = 'profile'\"\n        >\n          Profile\n        </li>\n        <li\n          :class=\"{ active: currentTab === 'items' }\"\n          @click=\"currentTab = 'items'\"\n        >\n          Manage Items\n        </li>\n\n        <li @click=\"toggleLeaves\" class=\"has-submenu\">\n          Leaves <span class=\"arrow\">{{ showLeaves ? \"â–¼\" : \"â–¶\" }}</span>\n        </li>\n        <ul v-if=\"showLeaves\" class=\"submenu\">\n          <li\n            :class=\"{ active: currentTab === 'apply-leave' }\"\n            @click.stop=\"currentTab = 'apply-leave'\"\n          >\n            Apply for Leave\n          </li>\n          <li\n            :class=\"{ active: currentTab === 'leave-status' }\"\n            @click.stop=\"currentTab = 'leave-status'\"\n          >\n            Leave Status\n          </li>\n        </ul>\n\n        <li @click=\"logout\">Logout</li>\n      </ul>\n    </aside>\n\n    <!-- Main Content -->\n    <main class=\"content\">\n      <!-- Dashboard Tab -->\n      <div v-if=\"currentTab === 'dashboard'\" class=\"dashboard-tab\">\n        <h2>Dashboard</h2>\n        <div class=\"stats-grid\">\n          <div class=\"stat-box total-items\">\n            Total Items: {{ stats.totalItems }}\n          </div>\n          <div class=\"stat-box leaves-taken\">\n            Leaves Taken: {{ stats.leavesTaken }}\n          </div>\n          <div class=\"stat-box pending-tasks\">\n            Pending Tasks: {{ stats.pendingTasks }}\n          </div>\n          <div class=\"stat-box completed-tasks\">\n            Completed Tasks: {{ stats.completedTasks }}\n          </div>\n        </div>\n      </div>\n\n      <!-- Profile Tab -->\n      <div v-if=\"currentTab === 'profile'\" class=\"profile-tab\">\n        <h2>My Profile</h2>\n        <div class=\"profile-card\">\n          <div class=\"photo-section\">\n            <img\n              :src=\"\n                staff.profilePhoto ? apiBase + staff.profilePhoto : defaultPhoto\n              \"\n              alt=\"Profile Photo\"\n              class=\"profile-photo\"\n            />\n            <input type=\"file\" @change=\"onFileChange\" />\n          </div>\n          <form @submit.prevent=\"updateProfile\" class=\"profile-form\">\n            <label>Name</label>\n            <input v-model=\"staff.name\" required />\n            <label>Email (cannot be changed)</label>\n            <input v-model=\"staff.email\" disabled />\n            <label>Phone</label>\n            <input v-model=\"staff.phone\" required />\n            <label>Gender</label>\n            <select v-model=\"staff.gender\">\n              <option value=\"male\">Male</option>\n              <option value=\"female\">Female</option>\n              <option value=\"other\">Other</option>\n            </select>\n            <label>Address</label>\n            <input v-model=\"staff.address\" required />\n            <label>Pincode</label>\n            <input v-model=\"staff.pincode\" required />\n            <button type=\"submit\">Update Profile</button>\n          </form>\n        </div>\n        <p v-if=\"message\" class=\"message\">{{ message }}</p>\n      </div>\n\n      <!-- Manage Items Tab -->\n      <div v-if=\"currentTab === 'items'\" class=\"items-tab\">\n        <h2>Manage Items</h2>\n        <p>ðŸ‘‰ Here you can add, update, or delete items.</p>\n      </div>\n\n      <!-- Apply Leave Tab -->\n      <div v-if=\"currentTab === 'apply-leave'\" class=\"apply-leave-tab\">\n        <StaffLeave @leave-submitted=\"fetchLeaveStatus\" />\n      </div>\n\n      <!-- Leave Status Tab -->\n      <div v-if=\"currentTab === 'leave-status'\" class=\"leave-status-tab\">\n        <h2>Leave Status</h2>\n        <table class=\"leave-table\">\n          <thead>\n            <tr>\n              <th>Reason</th>\n              <th>Date</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"leave in leaveStatus\" :key=\"leave._id\">\n              <td>{{ leave.reason }}</td>\n              <td>{{ formatDate(leave.date) }}</td>\n              <td>{{ leave.status }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </main>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport StaffLeave from \"./StaffLeave.vue\";\n\nexport default {\n  components: { StaffLeave },\n  data() {\n    return {\n      currentTab: \"dashboard\",\n      showLeaves: false,\n      staff: {\n        name: \"\",\n        email: \"\",\n        phone: \"\",\n        gender: \"\",\n        address: \"\",\n        pincode: \"\",\n        profilePhoto: \"\",\n      },\n      stats: {\n        totalItems: 0,\n        leavesTaken: 0,\n        pendingTasks: 0,\n        completedTasks: 0,\n      },\n      leaveStatus: [],\n      selectedFile: null,\n      message: \"\",\n      apiBase: \"http://localhost:5000\",\n      defaultPhoto: \"/default-avatar.png\",\n    };\n  },\n  methods: {\n    async fetchProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/staff/me`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        this.staff = res.data.staff;\n      } catch {\n        this.message = \"Error loading profile\";\n      }\n    },\n    async fetchStats() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/staff/stats`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        this.stats = res.data;\n      } catch (err) {\n        console.error(\"Error fetching stats\", err);\n      }\n    },\n    onFileChange(e) {\n      this.selectedFile = e.target.files[0];\n    },\n    async updateProfile() {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const formData = new FormData();\n        Object.keys(this.staff).forEach((key) => {\n          if (key !== \"email\") formData.append(key, this.staff[key]);\n        });\n        if (this.selectedFile)\n          formData.append(\"profilePhoto\", this.selectedFile);\n\n        const res = await axios.put(\n          `${this.apiBase}/api/staff/update`,\n          formData,\n          {\n            headers: {\n              Authorization: `Bearer ${token}`,\n              \"Content-Type\": \"multipart/form-data\",\n            },\n          }\n        );\n        this.message = res.data.message;\n        this.fetchProfile();\n      } catch (err) {\n        this.message = err.response?.data?.message || \"Error updating profile\";\n      }\n    },\n    toggleLeaves() {\n      this.showLeaves = !this.showLeaves;\n    },\n    logout() {\n      localStorage.removeItem(\"token\");\n      this.$router.push(\"/login\");\n    },\n    async fetchLeaveStatus() {\n      try {\n        const user = JSON.parse(localStorage.getItem(\"user\"));\n        const email = user?.email;\n        if (!email) return;\n\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(`${this.apiBase}/api/leaves/my`, {\n          headers: { Authorization: `Bearer ${token}` },\n          params: { email },\n        });\n\n        this.leaveStatus = res.data;\n      } catch (err) {\n        console.error(\"Error fetching leave status\", err);\n      }\n    },\n    formatDate(dateStr) {\n      return new Date(dateStr).toLocaleDateString();\n    },\n  },\n  watch: {\n    currentTab(newTab) {\n      if (newTab === \"leave-status\") this.fetchLeaveStatus();\n    },\n  },\n  mounted() {\n    this.fetchProfile();\n    this.fetchStats();\n  },\n};\n</script>\n\n<style scoped>\n.staff-dashboard {\n  display: flex;\n  min-height: 100vh;\n}\n\n/* Sidebar */\n.sidebar {\n  width: 220px;\n  background: #2c3e50;\n  color: white;\n  padding: 20px;\n}\n.sidebar-title {\n  font-size: 18px;\n  margin-bottom: 20px;\n}\n.sidebar ul {\n  list-style: none;\n  padding: 0;\n}\n.sidebar li {\n  padding: 12px 10px;\n  cursor: pointer;\n  border-radius: 6px;\n  transition: background 0.3s;\n}\n.sidebar li:hover,\n.sidebar li.active {\n  background: #34495e;\n}\n.has-submenu {\n  font-weight: bold;\n}\n.arrow {\n  float: right;\n}\n.submenu {\n  margin-left: 15px;\n}\n.submenu li {\n  padding: 8px 10px;\n  background: #3b4a5a;\n  border-radius: 4px;\n  margin: 4px 0;\n}\n.submenu li.active {\n  background: #1abc9c;\n}\n\n/* Content Area */\n.content {\n  flex: 1;\n  padding: 20px;\n  background: #f4f6f9;\n}\n\n/* Dashboard Boxes */\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 20px;\n}\n.stat-box {\n  padding: 20px;\n  border-radius: 10px;\n  color: white;\n  font-weight: bold;\n  text-align: center;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\n}\n.total-items {\n  background: #3498db;\n}\n.leaves-taken {\n  background: #e74c3c;\n}\n.pending-tasks {\n  background: #f39c12;\n}\n.completed-tasks {\n  background: #2ecc71;\n}\n\n/* Profile Card */\n.profile-card {\n  display: flex;\n  gap: 20px;\n  background: #fff;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);\n}\n.photo-section {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.profile-photo {\n  width: 120px;\n  height: 120px;\n  border-radius: 50%;\n  object-fit: cover;\n  margin-bottom: 10px;\n}\n.profile-form {\n  flex: 1;\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 15px;\n}\n.profile-form label {\n  grid-column: span 2;\n  font-weight: bold;\n}\n.profile-form input,\n.profile-form select,\n.profile-form textarea {\n  grid-column: span 2;\n  padding: 8px;\n  border-radius: 8px;\n  border: 1px solid #ccc;\n}\nbutton {\n  grid-column: span 2;\n  padding: 10px;\n  background: #007bff;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n}\nbutton:hover {\n  background: #0056b3;\n}\n\n/* Leave Table */\n.leave-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 15px;\n}\n.leave-table th,\n.leave-table td {\n  border: 1px solid #ccc;\n  padding: 10px;\n  text-align: center;\n}\n.leave-table th {\n  background: #34495e;\n  color: white;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}