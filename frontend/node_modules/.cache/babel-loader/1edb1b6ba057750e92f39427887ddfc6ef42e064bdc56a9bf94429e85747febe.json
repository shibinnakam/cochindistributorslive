{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport axios from \"axios\";\nimport jsPDF from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\nexport default {\n  data() {\n    return {\n      email: \"\",\n      staff: [],\n      toastMessage: \"\",\n      toastError: false,\n      today: new Date().toISOString().split(\"T\")[0] // ✅ for date picker max\n    };\n  },\n  methods: {\n    async fetchStaff() {\n      try {\n        const res = await axios.get(\"http://localhost:5000/api/staff\");\n        this.staff = res.data.staff.map(s => ({\n          ...s,\n          joiningDate: s.dateOfJoining ? new Date(s.dateOfJoining).toISOString().split(\"T\")[0] : new Date().toISOString().split(\"T\")[0] // default today\n        }));\n      } catch (err) {\n        this.showToast(\"Failed to fetch staff\", true);\n      }\n    },\n    async inviteStaff() {\n      try {\n        await axios.post(\"http://localhost:5000/api/staff/invite\", {\n          email: this.email\n        });\n        this.showToast(\"Invitation sent!\");\n        this.email = \"\";\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error sending invite\", true);\n      }\n    },\n    async approveStaff(id, joiningDate) {\n      if (!joiningDate) {\n        this.showToast(\"Please select a joining date\", true);\n        return;\n      }\n      try {\n        const res = await axios.put(`http://localhost:5000/api/staff/approve/${id}`, {\n          joiningDate\n        });\n        if (res.data.success) {\n          this.showToast(res.data.message);\n          this.fetchStaff();\n        }\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error approving staff\", true);\n      }\n    },\n    async setStatus(id, status) {\n      try {\n        await axios.put(`http://localhost:5000/api/staff/status/${id}`, {\n          status\n        });\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(\"Failed to update status\", true);\n      }\n    },\n    showToast(message, isError = false) {\n      this.toastMessage = message;\n      this.toastError = isError;\n      setTimeout(() => {\n        this.toastMessage = \"\";\n        this.toastError = false;\n      }, 3000);\n    },\n    // --- PDF methods (unchanged) ---\n    exportStaffPDF(staff) {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(`${staff.name || \"staff\"}_details.pdf`);\n    },\n    exportAllStaffPDF() {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(\"staff-report.pdf\");\n    }\n  },\n  mounted() {\n    this.fetchStaff();\n  }\n};","map":{"version":3,"names":["axios","jsPDF","autoTable","data","email","staff","toastMessage","toastError","today","Date","toISOString","split","methods","fetchStaff","res","get","map","s","joiningDate","dateOfJoining","err","showToast","inviteStaff","post","response","message","approveStaff","id","put","success","setStatus","status","isError","setTimeout","exportStaffPDF","doc","save","name","exportAllStaffPDF","mounted"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffManagement.vue"],"sourcesContent":["<template>\n  <div class=\"staff-management\">\n    <h2>Staff Management</h2>\n\n    <!-- Invite Form -->\n    <form @submit.prevent=\"inviteStaff\" class=\"invite-form\">\n      <input\n        v-model=\"email\"\n        type=\"email\"\n        placeholder=\"Enter staff email\"\n        required\n      />\n      <button type=\"submit\">Invite</button>\n    </form>\n\n    <!-- Toast Notification -->\n    <div v-if=\"toastMessage\" :class=\"['toast', toastError ? 'error' : 'success']\">\n      {{ toastMessage }}\n    </div>\n\n    <!-- Staff List -->\n    <h3>Staff List</h3>\n    <table>\n      <thead>\n        <tr>\n          <th>Email</th>\n          <th>Name</th>\n          <th>Phone</th>\n          <th>Date of Joining</th>\n          <th>Status</th>\n          <th>Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"s in staff\" :key=\"s._id\">\n          <td>{{ s.email }}</td>\n          <td>{{ s.name || \"—\" }}</td>\n          <td>{{ s.phone || \"—\" }}</td>\n          <td>\n            {{\n              s.dateOfJoining\n                ? new Date(s.dateOfJoining).toLocaleDateString()\n                : \"—\"\n            }}\n          </td>\n          <td>{{ s.status }}</td>\n          <td>\n            <!-- Approve with date selection -->\n            <div v-if=\"s.status === 'pending'\" class=\"approve-container\">\n              <input\n                type=\"date\"\n                v-model=\"s.joiningDate\"\n                :max=\"today\"\n                required\n              />\n              <button @click=\"approveStaff(s._id, s.joiningDate)\">\n                Approve\n              </button>\n            </div>\n\n            <button\n              v-if=\"s.status === 'active'\"\n              @click=\"setStatus(s._id, 'deactivated')\"\n            >\n              Deactivate\n            </button>\n            <button\n              v-if=\"s.status === 'deactivated'\"\n              @click=\"setStatus(s._id, 'active')\"\n            >\n              Activate\n            </button>\n\n            <!-- PDF -->\n            <button @click=\"exportStaffPDF(s)\">Download PDF</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- Export All -->\n    <button @click=\"exportAllStaffPDF\" class=\"export-all\">\n      Download All Staff Report\n    </button>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport jsPDF from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\n\nexport default {\n  data() {\n    return {\n      email: \"\",\n      staff: [],\n      toastMessage: \"\",\n      toastError: false,\n      today: new Date().toISOString().split(\"T\")[0], // ✅ for date picker max\n    };\n  },\n  methods: {\n    async fetchStaff() {\n      try {\n        const res = await axios.get(\"http://localhost:5000/api/staff\");\n        this.staff = res.data.staff.map((s) => ({\n          ...s,\n          joiningDate: s.dateOfJoining\n            ? new Date(s.dateOfJoining).toISOString().split(\"T\")[0]\n            : new Date().toISOString().split(\"T\")[0], // default today\n        }));\n      } catch (err) {\n        this.showToast(\"Failed to fetch staff\", true);\n      }\n    },\n    async inviteStaff() {\n      try {\n        await axios.post(\"http://localhost:5000/api/staff/invite\", {\n          email: this.email,\n        });\n        this.showToast(\"Invitation sent!\");\n        this.email = \"\";\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error sending invite\", true);\n      }\n    },\n    async approveStaff(id, joiningDate) {\n      if (!joiningDate) {\n        this.showToast(\"Please select a joining date\", true);\n        return;\n      }\n      try {\n        const res = await axios.put(\n          `http://localhost:5000/api/staff/approve/${id}`,\n          { joiningDate }\n        );\n        if (res.data.success) {\n          this.showToast(res.data.message);\n          this.fetchStaff();\n        }\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error approving staff\", true);\n      }\n    },\n    async setStatus(id, status) {\n      try {\n        await axios.put(`http://localhost:5000/api/staff/status/${id}`, { status });\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(\"Failed to update status\", true);\n      }\n    },\n    showToast(message, isError = false) {\n      this.toastMessage = message;\n      this.toastError = isError;\n      setTimeout(() => {\n        this.toastMessage = \"\";\n        this.toastError = false;\n      }, 3000);\n    },\n\n    // --- PDF methods (unchanged) ---\n    exportStaffPDF(staff) {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(`${staff.name || \"staff\"}_details.pdf`);\n    },\n    exportAllStaffPDF() {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(\"staff-report.pdf\");\n    },\n  },\n  mounted() {\n    this.fetchStaff();\n  },\n};\n</script>\n\n<style scoped>\n.staff-management {\n  max-width: 1000px;\n  margin: 20px auto;\n  padding: 20px;\n  background: #fff;\n  border-radius: 10px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invite-form {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 20px;\n}\n.invite-form input {\n  flex: 1;\n  padding: 8px;\n}\n.invite-form button {\n  padding: 8px 15px;\n}\n.approve-container {\n  display: flex;\n  gap: 5px;\n  align-items: center;\n}\n.toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  padding: 12px 20px;\n  border-radius: 8px;\n  color: #fff;\n  z-index: 9999;\n  transition: all 0.3s ease;\n}\n.toast.success {\n  background: #48bb78;\n}\n.toast.error {\n  background: #f56565;\n}\ntable {\n  width: 100%;\n  border-collapse: collapse;\n  margin-bottom: 20px;\n}\nth, td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: center;\n}\nbutton {\n  padding: 5px 10px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n}\nbutton:hover {\n  opacity: 0.85;\n}\n.export-all {\n  background: #4cafef;\n  color: #fff;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}