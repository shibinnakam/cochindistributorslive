{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"staff-management\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"approve-container\"\n};\nconst _hoisted_3 = [\"onUpdate:modelValue\", \"max\"];\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", null, \"Staff Management\", -1 /* CACHED */)), _createCommentVNode(\" Invite Form \"), _createElementVNode(\"form\", {\n    onSubmit: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.inviteStaff && $options.inviteStaff(...args), [\"prevent\"])),\n    class: \"invite-form\"\n  }, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    type: \"email\",\n    placeholder: \"Enter staff email\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.email]]), _cache[3] || (_cache[3] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"Invite\", -1 /* CACHED */))], 32 /* NEED_HYDRATION */), _createCommentVNode(\" Toast Notification \"), $data.toastMessage ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: _normalizeClass(['toast', $data.toastError ? 'error' : 'success'])\n  }, _toDisplayString($data.toastMessage), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Staff List \"), _cache[6] || (_cache[6] = _createElementVNode(\"h3\", null, \"Staff List\", -1 /* CACHED */)), _createElementVNode(\"table\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Email\"), _createElementVNode(\"th\", null, \"Name\"), _createElementVNode(\"th\", null, \"Phone\"), _createElementVNode(\"th\", null, \"Date of Joining\"), _createElementVNode(\"th\", null, \"Status\"), _createElementVNode(\"th\", null, \"Action\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.staff, s => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: s._id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(s.email), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(s.name || \"—\"), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(s.phone || \"—\"), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(s.dateOfJoining ? new Date(s.dateOfJoining).toLocaleDateString() : \"—\"), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(s.status), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createCommentVNode(\" Approve with date selection \"), s.status === 'pending' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"date\",\n      \"onUpdate:modelValue\": $event => s.joiningDate = $event,\n      max: $data.today,\n      required: \"\"\n    }, null, 8 /* PROPS */, _hoisted_3), [[_vModelText, s.joiningDate]]), _createElementVNode(\"button\", {\n      onClick: $event => $options.approveStaff(s._id, s.joiningDate)\n    }, \" Approve \", 8 /* PROPS */, _hoisted_4)])) : _createCommentVNode(\"v-if\", true), s.status === 'active' ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 1,\n      onClick: $event => $options.setStatus(s._id, 'deactivated')\n    }, \" Deactivate \", 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true), s.status === 'deactivated' ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 2,\n      onClick: $event => $options.setStatus(s._id, 'active')\n    }, \" Activate \", 8 /* PROPS */, _hoisted_6)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" PDF \"), _createElementVNode(\"button\", {\n      onClick: $event => $options.exportStaffPDF(s)\n    }, \"Download PDF\", 8 /* PROPS */, _hoisted_7)])]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createCommentVNode(\" Export All \"), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.exportAllStaffPDF && $options.exportAllStaffPDF(...args)),\n    class: \"export-all\"\n  }, \" Download All Staff Report \")]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","onSubmit","_cache","_withModifiers","args","$options","inviteStaff","$data","email","$event","type","placeholder","required","toastMessage","_normalizeClass","toastError","_Fragment","_renderList","staff","s","key","_id","_toDisplayString","name","phone","dateOfJoining","Date","toLocaleDateString","status","_hoisted_2","joiningDate","max","today","onClick","approveStaff","_hoisted_4","setStatus","_hoisted_5","_hoisted_6","exportStaffPDF","_hoisted_7","exportAllStaffPDF"],"sources":["C:\\Users\\LENOVO\\Music\\distribution-agency-project\\frontend\\src\\views\\StaffManagement.vue"],"sourcesContent":["<template>\n  <div class=\"staff-management\">\n    <h2>Staff Management</h2>\n\n    <!-- Invite Form -->\n    <form @submit.prevent=\"inviteStaff\" class=\"invite-form\">\n      <input\n        v-model=\"email\"\n        type=\"email\"\n        placeholder=\"Enter staff email\"\n        required\n      />\n      <button type=\"submit\">Invite</button>\n    </form>\n\n    <!-- Toast Notification -->\n    <div v-if=\"toastMessage\" :class=\"['toast', toastError ? 'error' : 'success']\">\n      {{ toastMessage }}\n    </div>\n\n    <!-- Staff List -->\n    <h3>Staff List</h3>\n    <table>\n      <thead>\n        <tr>\n          <th>Email</th>\n          <th>Name</th>\n          <th>Phone</th>\n          <th>Date of Joining</th>\n          <th>Status</th>\n          <th>Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"s in staff\" :key=\"s._id\">\n          <td>{{ s.email }}</td>\n          <td>{{ s.name || \"—\" }}</td>\n          <td>{{ s.phone || \"—\" }}</td>\n          <td>\n            {{\n              s.dateOfJoining\n                ? new Date(s.dateOfJoining).toLocaleDateString()\n                : \"—\"\n            }}\n          </td>\n          <td>{{ s.status }}</td>\n          <td>\n            <!-- Approve with date selection -->\n            <div v-if=\"s.status === 'pending'\" class=\"approve-container\">\n              <input\n                type=\"date\"\n                v-model=\"s.joiningDate\"\n                :max=\"today\"\n                required\n              />\n              <button @click=\"approveStaff(s._id, s.joiningDate)\">\n                Approve\n              </button>\n            </div>\n\n            <button\n              v-if=\"s.status === 'active'\"\n              @click=\"setStatus(s._id, 'deactivated')\"\n            >\n              Deactivate\n            </button>\n            <button\n              v-if=\"s.status === 'deactivated'\"\n              @click=\"setStatus(s._id, 'active')\"\n            >\n              Activate\n            </button>\n\n            <!-- PDF -->\n            <button @click=\"exportStaffPDF(s)\">Download PDF</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- Export All -->\n    <button @click=\"exportAllStaffPDF\" class=\"export-all\">\n      Download All Staff Report\n    </button>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport jsPDF from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\n\nexport default {\n  data() {\n    return {\n      email: \"\",\n      staff: [],\n      toastMessage: \"\",\n      toastError: false,\n      today: new Date().toISOString().split(\"T\")[0], // ✅ for date picker max\n    };\n  },\n  methods: {\n    async fetchStaff() {\n      try {\n        const res = await axios.get(\"http://localhost:5000/api/staff\");\n        this.staff = res.data.staff.map((s) => ({\n          ...s,\n          joiningDate: s.dateOfJoining\n            ? new Date(s.dateOfJoining).toISOString().split(\"T\")[0]\n            : new Date().toISOString().split(\"T\")[0], // default today\n        }));\n      } catch (err) {\n        this.showToast(\"Failed to fetch staff\", true);\n      }\n    },\n    async inviteStaff() {\n      try {\n        await axios.post(\"http://localhost:5000/api/staff/invite\", {\n          email: this.email,\n        });\n        this.showToast(\"Invitation sent!\");\n        this.email = \"\";\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error sending invite\", true);\n      }\n    },\n    async approveStaff(id, joiningDate) {\n      if (!joiningDate) {\n        this.showToast(\"Please select a joining date\", true);\n        return;\n      }\n      try {\n        const res = await axios.put(\n          `http://localhost:5000/api/staff/approve/${id}`,\n          { joiningDate }\n        );\n        if (res.data.success) {\n          this.showToast(res.data.message);\n          this.fetchStaff();\n        }\n      } catch (err) {\n        this.showToast(err.response?.data?.message || \"Error approving staff\", true);\n      }\n    },\n    async setStatus(id, status) {\n      try {\n        await axios.put(`http://localhost:5000/api/staff/status/${id}`, { status });\n        this.fetchStaff();\n      } catch (err) {\n        this.showToast(\"Failed to update status\", true);\n      }\n    },\n    showToast(message, isError = false) {\n      this.toastMessage = message;\n      this.toastError = isError;\n      setTimeout(() => {\n        this.toastMessage = \"\";\n        this.toastError = false;\n      }, 3000);\n    },\n\n    // --- PDF methods (unchanged) ---\n    exportStaffPDF(staff) {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(`${staff.name || \"staff\"}_details.pdf`);\n    },\n    exportAllStaffPDF() {\n      const doc = new jsPDF();\n      // ... existing PDF code ...\n      doc.save(\"staff-report.pdf\");\n    },\n  },\n  mounted() {\n    this.fetchStaff();\n  },\n};\n</script>\n\n<style scoped>\n.staff-management {\n  max-width: 1000px;\n  margin: 20px auto;\n  padding: 20px;\n  background: #fff;\n  border-radius: 10px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n.invite-form {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 20px;\n}\n.invite-form input {\n  flex: 1;\n  padding: 8px;\n}\n.invite-form button {\n  padding: 8px 15px;\n}\n.approve-container {\n  display: flex;\n  gap: 5px;\n  align-items: center;\n}\n.toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  padding: 12px 20px;\n  border-radius: 8px;\n  color: #fff;\n  z-index: 9999;\n  transition: all 0.3s ease;\n}\n.toast.success {\n  background: #48bb78;\n}\n.toast.error {\n  background: #f56565;\n}\ntable {\n  width: 100%;\n  border-collapse: collapse;\n  margin-bottom: 20px;\n}\nth, td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: center;\n}\nbutton {\n  padding: 5px 10px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n}\nbutton:hover {\n  opacity: 0.85;\n}\n.export-all {\n  background: #4cafef;\n  color: #fff;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}